(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"warnOnce",{enumerable:!0,get:function(){return r}});let r=e=>{}},18581,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"useMergedRef",{enumerable:!0,get:function(){return n}});let r=e.r(71645);function n(e,t){let a=(0,r.useRef)(null),n=(0,r.useRef)(null);return(0,r.useCallback)(r=>{if(null===r){let e=a.current;e&&(a.current=null,e());let t=n.current;t&&(n.current=null,t())}else e&&(a.current=i(e,r)),t&&(n.current=i(t,r))},[e,t])}function i(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let a=e(t);return"function"==typeof a?a:()=>e(null)}}("function"==typeof a.default||"object"==typeof a.default&&null!==a.default)&&void 0===a.default.__esModule&&(Object.defineProperty(a.default,"__esModule",{value:!0}),Object.assign(a.default,a),t.exports=a.default)},98183,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r={assign:function(){return l},searchParamsToUrlQuery:function(){return i},urlQueryToSearchParams:function(){return o}};for(var n in r)Object.defineProperty(a,n,{enumerable:!0,get:r[n]});function i(e){let t={};for(let[a,r]of e.entries()){let e=t[a];void 0===e?t[a]=r:Array.isArray(e)?e.push(r):t[a]=[e,r]}return t}function s(e){return"string"==typeof e?e:("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function o(e){let t=new URLSearchParams;for(let[a,r]of Object.entries(e))if(Array.isArray(r))for(let e of r)t.append(a,s(e));else t.set(a,s(r));return t}function l(e,...t){for(let a of t){for(let t of a.keys())e.delete(t);for(let[t,r]of a.entries())e.append(t,r)}return e}},95057,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r={formatUrl:function(){return o},formatWithValidation:function(){return c},urlObjectKeys:function(){return l}};for(var n in r)Object.defineProperty(a,n,{enumerable:!0,get:r[n]});let i=e.r(90809)._(e.r(98183)),s=/https?|ftp|gopher|file/;function o(e){let{auth:t,hostname:a}=e,r=e.protocol||"",n=e.pathname||"",o=e.hash||"",l=e.query||"",c=!1;t=t?encodeURIComponent(t).replace(/%3A/i,":")+"@":"",e.host?c=t+e.host:a&&(c=t+(~a.indexOf(":")?`[${a}]`:a),e.port&&(c+=":"+e.port)),l&&"object"==typeof l&&(l=String(i.urlQueryToSearchParams(l)));let d=e.search||l&&`?${l}`||"";return r&&!r.endsWith(":")&&(r+=":"),e.slashes||(!r||s.test(r))&&!1!==c?(c="//"+(c||""),n&&"/"!==n[0]&&(n="/"+n)):c||(c=""),o&&"#"!==o[0]&&(o="#"+o),d&&"?"!==d[0]&&(d="?"+d),n=n.replace(/[?#]/g,encodeURIComponent),d=d.replace("#","%23"),`${r}${c}${n}${d}${o}`}let l=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function c(e){return o(e)}},18967,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r={DecodeError:function(){return x},MiddlewareNotFoundError:function(){return j},MissingStaticPage:function(){return v},NormalizeError:function(){return y},PageNotFoundError:function(){return b},SP:function(){return h},ST:function(){return g},WEB_VITALS:function(){return i},execOnce:function(){return s},getDisplayName:function(){return u},getLocationOrigin:function(){return c},getURL:function(){return d},isAbsoluteUrl:function(){return l},isResSent:function(){return p},loadGetInitialProps:function(){return f},normalizeRepeatedSlashes:function(){return m},stringifyError:function(){return w}};for(var n in r)Object.defineProperty(a,n,{enumerable:!0,get:r[n]});let i=["CLS","FCP","FID","INP","LCP","TTFB"];function s(e){let t,a=!1;return(...r)=>(a||(a=!0,t=e(...r)),t)}let o=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,l=e=>o.test(e);function c(){let{protocol:e,hostname:t,port:a}=window.location;return`${e}//${t}${a?":"+a:""}`}function d(){let{href:e}=window.location,t=c();return e.substring(t.length)}function u(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function p(e){return e.finished||e.headersSent}function m(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?`?${t.slice(1).join("?")}`:"")}async function f(e,t){let a=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await f(t.Component,t.ctx)}:{};let r=await e.getInitialProps(t);if(a&&p(a))return r;if(!r)throw Object.defineProperty(Error(`"${u(e)}.getInitialProps()" should resolve to an object. But found "${r}" instead.`),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return r}let h="undefined"!=typeof performance,g=h&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class x extends Error{}class y extends Error{}class b extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message=`Cannot find module for page: ${e}`}}class v extends Error{constructor(e,t){super(),this.message=`Failed to load static file for page: ${e} ${t}`}}class j extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function w(e){return JSON.stringify({message:e.message,stack:e.stack})}},73668,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"isLocalURL",{enumerable:!0,get:function(){return i}});let r=e.r(18967),n=e.r(52817);function i(e){if(!(0,r.isAbsoluteUrl)(e))return!0;try{let t=(0,r.getLocationOrigin)(),a=new URL(e,t);return a.origin===t&&(0,n.hasBasePath)(a.pathname)}catch(e){return!1}}},84508,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"errorOnce",{enumerable:!0,get:function(){return r}});let r=e=>{}},22016,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r={default:function(){return x},useLinkStatus:function(){return b}};for(var n in r)Object.defineProperty(a,n,{enumerable:!0,get:r[n]});let i=e.r(90809),s=e.r(43476),o=i._(e.r(71645)),l=e.r(95057),c=e.r(8372),d=e.r(18581),u=e.r(18967),p=e.r(5550);e.r(33525);let m=e.r(91949),f=e.r(73668),h=e.r(9396);function g(e){return"string"==typeof e?e:(0,l.formatUrl)(e)}function x(t){var a;let r,n,i,[l,x]=(0,o.useOptimistic)(m.IDLE_LINK_STATUS),b=(0,o.useRef)(null),{href:v,as:j,children:w,prefetch:N=null,passHref:S,replace:k,shallow:_,scroll:C,onClick:O,onMouseEnter:T,onTouchStart:E,legacyBehavior:A=!1,onNavigate:P,ref:I,unstable_dynamicOnHover:$,...M}=t;r=w,A&&("string"==typeof r||"number"==typeof r)&&(r=(0,s.jsx)("a",{children:r}));let q=o.default.useContext(c.AppRouterContext),U=!1!==N,R=!1!==N?null===(a=N)||"auto"===a?h.FetchStrategy.PPR:h.FetchStrategy.Full:h.FetchStrategy.PPR,{href:L,as:F}=o.default.useMemo(()=>{let e=g(v);return{href:e,as:j?g(j):e}},[v,j]);if(A){if(r?.$$typeof===Symbol.for("react.lazy"))throw Object.defineProperty(Error("`<Link legacyBehavior>` received a direct child that is either a Server Component, or JSX that was loaded with React.lazy(). This is not supported. Either remove legacyBehavior, or make the direct child a Client Component that renders the Link's `<a>` tag."),"__NEXT_ERROR_CODE",{value:"E863",enumerable:!1,configurable:!0});n=o.default.Children.only(r)}let J=A?n&&"object"==typeof n&&n.ref:I,B=o.default.useCallback(e=>(null!==q&&(b.current=(0,m.mountLinkInstance)(e,L,q,R,U,x)),()=>{b.current&&((0,m.unmountLinkForCurrentNavigation)(b.current),b.current=null),(0,m.unmountPrefetchableInstance)(e)}),[U,L,q,R,x]),D={ref:(0,d.useMergedRef)(B,J),onClick(t){A||"function"!=typeof O||O(t),A&&n.props&&"function"==typeof n.props.onClick&&n.props.onClick(t),!q||t.defaultPrevented||function(t,a,r,n,i,s,l){if("undefined"!=typeof window){let c,{nodeName:d}=t.currentTarget;if("A"===d.toUpperCase()&&((c=t.currentTarget.getAttribute("target"))&&"_self"!==c||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||t.nativeEvent&&2===t.nativeEvent.which)||t.currentTarget.hasAttribute("download"))return;if(!(0,f.isLocalURL)(a)){i&&(t.preventDefault(),location.replace(a));return}if(t.preventDefault(),l){let e=!1;if(l({preventDefault:()=>{e=!0}}),e)return}let{dispatchNavigateAction:u}=e.r(99781);o.default.startTransition(()=>{u(r||a,i?"replace":"push",s??!0,n.current)})}}(t,L,F,b,k,C,P)},onMouseEnter(e){A||"function"!=typeof T||T(e),A&&n.props&&"function"==typeof n.props.onMouseEnter&&n.props.onMouseEnter(e),q&&U&&(0,m.onNavigationIntent)(e.currentTarget,!0===$)},onTouchStart:function(e){A||"function"!=typeof E||E(e),A&&n.props&&"function"==typeof n.props.onTouchStart&&n.props.onTouchStart(e),q&&U&&(0,m.onNavigationIntent)(e.currentTarget,!0===$)}};return(0,u.isAbsoluteUrl)(F)?D.href=F:A&&!S&&("a"!==n.type||"href"in n.props)||(D.href=(0,p.addBasePath)(F)),i=A?o.default.cloneElement(n,D):(0,s.jsx)("a",{...M,...D,children:r}),(0,s.jsx)(y.Provider,{value:l,children:i})}e.r(84508);let y=(0,o.createContext)(m.IDLE_LINK_STATUS),b=()=>(0,o.useContext)(y);("function"==typeof a.default||"object"==typeof a.default&&null!==a.default)&&void 0===a.default.__esModule&&(Object.defineProperty(a.default,"__esModule",{value:!0}),Object.assign(a.default,a),t.exports=a.default)},9156,(e,t,a)=>{"use strict";let r;Object.defineProperty(a,"__esModule",{value:!0}),a.parseCookie=u,a.parse=u,a.stringifyCookie=function(e,t){let a=t?.encode||encodeURIComponent,r=[];for(let t of Object.keys(e)){let s=e[t];if(void 0===s)continue;if(!n.test(t))throw TypeError(`cookie name is invalid: ${t}`);let o=a(s);if(!i.test(o))throw TypeError(`cookie val is invalid: ${s}`);r.push(`${t}=${o}`)}return r.join("; ")},a.stringifySetCookie=p,a.serialize=p,a.parseSetCookie=function(e,t){let a=t?.decode||g,r=e.length,n=m(e,0,r),i=f(e,0,n),s=-1===i?{name:"",value:a(h(e,0,n))}:{name:h(e,0,i),value:a(h(e,i+1,n))},o=n+1;for(;o<r;){let t=m(e,o,r),a=f(e,o,t),n=-1===a?h(e,o,t):h(e,o,a),i=-1===a?void 0:h(e,a+1,t);switch(n.toLowerCase()){case"httponly":s.httpOnly=!0;break;case"secure":s.secure=!0;break;case"partitioned":s.partitioned=!0;break;case"domain":s.domain=i;break;case"path":s.path=i;break;case"max-age":i&&l.test(i)&&(s.maxAge=Number(i));break;case"expires":if(!i)break;let c=new Date(i);Number.isFinite(c.valueOf())&&(s.expires=c);break;case"priority":if(!i)break;let d=i.toLowerCase();("low"===d||"medium"===d||"high"===d)&&(s.priority=d);break;case"samesite":if(!i)break;let u=i.toLowerCase();("lax"===u||"strict"===u||"none"===u)&&(s.sameSite=u)}o=t+1}return s},a.stringifySetCookie=p,a.serialize=p;let n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,i=/^[\u0021-\u003A\u003C-\u007E]*$/,s=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,o=/^[\u0020-\u003A\u003D-\u007E]*$/,l=/^-?\d+$/,c=Object.prototype.toString,d=((r=function(){}).prototype=Object.create(null),r);function u(e,t){let a=new d,r=e.length;if(r<2)return a;let n=t?.decode||g,i=0;do{let t=f(e,i,r);if(-1===t)break;let s=m(e,i,r);if(t>s){i=e.lastIndexOf(";",t-1)+1;continue}let o=h(e,i,t);void 0===a[o]&&(a[o]=n(h(e,t+1,s))),i=s+1}while(i<r)return a}function p(e,t,a){let r="object"==typeof e?e:{...a,name:e,value:String(t)},l=("object"==typeof t?t:a)?.encode||encodeURIComponent;if(!n.test(r.name))throw TypeError(`argument name is invalid: ${r.name}`);let d=r.value?l(r.value):"";if(!i.test(d))throw TypeError(`argument val is invalid: ${r.value}`);let u=r.name+"="+d;if(void 0!==r.maxAge){if(!Number.isInteger(r.maxAge))throw TypeError(`option maxAge is invalid: ${r.maxAge}`);u+="; Max-Age="+r.maxAge}if(r.domain){if(!s.test(r.domain))throw TypeError(`option domain is invalid: ${r.domain}`);u+="; Domain="+r.domain}if(r.path){if(!o.test(r.path))throw TypeError(`option path is invalid: ${r.path}`);u+="; Path="+r.path}if(r.expires){var p;if(p=r.expires,"[object Date]"!==c.call(p)||!Number.isFinite(r.expires.valueOf()))throw TypeError(`option expires is invalid: ${r.expires}`);u+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(u+="; HttpOnly"),r.secure&&(u+="; Secure"),r.partitioned&&(u+="; Partitioned"),r.priority)switch("string"==typeof r.priority?r.priority.toLowerCase():void 0){case"low":u+="; Priority=Low";break;case"medium":u+="; Priority=Medium";break;case"high":u+="; Priority=High";break;default:throw TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch("string"==typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":u+="; SameSite=Strict";break;case"lax":u+="; SameSite=Lax";break;case"none":u+="; SameSite=None";break;default:throw TypeError(`option sameSite is invalid: ${r.sameSite}`)}return u}function m(e,t,a){let r=e.indexOf(";",t);return -1===r?a:r}function f(e,t,a){let r=e.indexOf("=",t);return r<a?r:-1}function h(e,t,a){let r=t,n=a;do{let t=e.charCodeAt(r);if(32!==t&&9!==t)break}while(++r<n)for(;n>r;){let t=e.charCodeAt(n-1);if(32!==t&&9!==t)break;n--}return e.slice(r,n)}function g(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}},52683,(e,t,a)=>{},2410,e=>{"use strict";let t;var a=e.i(47167),r=e.i(88715),n=e.i(9156);function i(){return"undefined"!=typeof window&&void 0!==window.document}n.parse,n.serialize;let s={path:"/",sameSite:"lax",httpOnly:!1,maxAge:3456e4},o=/^(.*)[.](0|[1-9][0-9]*)$/;function l(e,t){if(e===t)return!0;let a=e.match(o);return!!a&&a[1]===t}function c(e,t,a){let r=a??3180,n=encodeURIComponent(t);if(n.length<=r)return[{name:e,value:t}];let i=[];for(;n.length>0;){let e=n.slice(0,r),t=e.lastIndexOf("%");t>r-3&&(e=e.slice(0,t));let a="";for(;e.length>0;)try{a=decodeURIComponent(e);break}catch(t){if(t instanceof URIError&&"%"===e.at(-3)&&e.length>3)e=e.slice(0,e.length-3);else throw t}i.push(a),n=n.slice(e.length)}return i.map((t,a)=>({name:`${e}.${a}`,value:t}))}async function d(e,t){let a=await t(e);if(a)return a;let r=[];for(let a=0;;a++){let n=`${e}.${a}`,i=await t(n);if(!i)break;r.push(i)}return r.length>0?r.join(""):null}let u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),p=" 	\n\r=".split(""),m=(()=>{let e=Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<p.length;t+=1)e[p[t].charCodeAt(0)]=-2;for(let t=0;t<u.length;t+=1)e[u[t].charCodeAt(0)]=t;return e})();function f(e){let t=[],a=0,r=0;if(function(e,t){for(let a=0;a<e.length;a+=1){let r=e.charCodeAt(a);if(r>55295&&r<=56319){let t=(r-55296)*1024&65535;r=(e.charCodeAt(a+1)-56320&65535|t)+65536,a+=1}!function(e,t){if(e<=127)return t(e);if(e<=2047){t(192|e>>6),t(128|63&e);return}if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|63&e);return}if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|63&e);return}throw Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}(r,t)}}(e,e=>{for(a=a<<8|e,r+=8;r>=6;){let e=a>>r-6&63;t.push(u[e]),r-=6}}),r>0)for(a<<=6-r,r=6;r>=6;){let e=a>>r-6&63;t.push(u[e]),r-=6}return t.join("")}function h(e){let t=[],a=e=>{t.push(String.fromCodePoint(e))},r={utf8seq:0,codepoint:0},n=0,i=0;for(let t=0;t<e.length;t+=1){let s=m[e.charCodeAt(t)];if(s>-1)for(n=n<<6|s,i+=6;i>=8;)(function(e,t,a){if(0===t.utf8seq){if(e<=127)return a(e);for(let a=1;a<6;a+=1)if((e>>7-a&1)==0){t.utf8seq=a;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else if(4===t.utf8seq)t.codepoint=7&e;else throw Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&a(t.codepoint)}})(n>>i-8&255,r,a),i-=8;else if(-2===s)continue;else throw Error(`Invalid Base64-URL character "${e.at(t)}" at position ${t}`)}return t.join("")}let g="base64-";async function x({getAll:e,setAll:t,setItems:a,removedItems:r},n){let i=n.cookieEncoding,o=n.cookieOptions??null,d=await e([...a?Object.keys(a):[],...r?Object.keys(r):[]]),u=d?.map(({name:e})=>e)||[],p=Object.keys(r).flatMap(e=>u.filter(t=>l(t,e))),m=Object.keys(a).flatMap(e=>{let t=new Set(u.filter(t=>l(t,e))),r=a[e];"base64url"===i&&(r=g+f(r));let n=c(e,r);return n.forEach(e=>{t.delete(e.name)}),p.push(...t),n}),h={...s,...o,maxAge:0},x={...s,...o,maxAge:s.maxAge};delete h.name,delete x.name,await t([...p.map(e=>({name:e,value:"",options:h})),...m.map(({name:e,value:t})=>({name:e,value:t,options:x}))])}if(e.i(52683),void 0!==a.default&&a.default.env?.npm_package_name){let e=a.default.env.npm_package_name;["@supabase/auth-helpers-nextjs","@supabase/auth-helpers-react","@supabase/auth-helpers-remix","@supabase/auth-helpers-sveltekit"].includes(e)&&console.warn(`
╔════════════════════════════════════════════════════════════════════════════╗
║ ⚠️  IMPORTANT: Package Consolidation Notice                                ║
║                                                                            ║
║ The ${e.padEnd(35)} package name is deprecated.  ║
║                                                                            ║
║ You are now using @supabase/ssr - a unified solution for all frameworks.  ║
║                                                                            ║
║ The auth-helpers packages have been consolidated into @supabase/ssr       ║
║ to provide better maintenance and consistent APIs across frameworks.      ║
║                                                                            ║
║ Please update your package.json to use @supabase/ssr directly:            ║
║   npm uninstall ${e.padEnd(42)} ║
║   npm install @supabase/ssr                                               ║
║                                                                            ║
║ For more information, visit:                                              ║
║ https://supabase.com/docs/guides/auth/server-side                         ║
╚════════════════════════════════════════════════════════════════════════════╝
    `)}function y(){return function(e,a,o){let u=i();if(u&&t)return t;if(!e||!a)throw Error(`@supabase/ssr: Your project's URL and API key are required to create a Supabase client!

Check your Supabase project's API settings to find these values

https://supabase.com/dashboard/project/_/settings/api`);let{storage:p}=function(e,t){let a,r,o=e.cookies??null,u=e.cookieEncoding,p={},m={};if(o)if("get"in o){let e=async e=>{let t=e.flatMap(e=>[e,...Array.from({length:5}).map((t,a)=>`${e}.${a}`)]),a=[];for(let e=0;e<t.length;e+=1){let r=await o.get(t[e]);(r||"string"==typeof r)&&a.push({name:t[e],value:r})}return a};if(a=async t=>await e(t),"set"in o&&"remove"in o)r=async e=>{for(let t=0;t<e.length;t+=1){let{name:a,value:r,options:n}=e[t];r?await o.set(a,r,n):await o.remove(a,n)}};else if(t)r=async()=>{console.warn("@supabase/ssr: createServerClient was configured without set and remove cookie methods, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness. Consider switching to the getAll and setAll cookie methods instead of get, set and remove which are deprecated and can be difficult to use correctly.")};else throw Error("@supabase/ssr: createBrowserClient requires configuring a getAll and setAll cookie method (deprecated: alternatively both get, set and remove can be used)")}else if("getAll"in o)if(a=async()=>await o.getAll(),"setAll"in o)r=o.setAll;else if(t)r=async()=>{console.warn("@supabase/ssr: createServerClient was configured without the setAll cookie method, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness.")};else throw Error("@supabase/ssr: createBrowserClient requires configuring both getAll and setAll cookie methods (deprecated: alternatively both get, set and remove can be used)");else throw Error(`@supabase/ssr: ${t?"createServerClient":"createBrowserClient"} requires configuring getAll and setAll cookie methods (deprecated: alternatively use get, set and remove).${i()?" As this is called in a browser runtime, consider removing the cookies option object to use the document.cookie API automatically.":""}`);else if(!t&&i())a=()=>{let e;return Object.keys(e=(0,n.parse)(document.cookie)).map(t=>({name:t,value:e[t]??""}))},r=e=>{e.forEach(({name:e,value:t,options:a})=>{document.cookie=(0,n.serialize)(e,t,a)})};else if(t)throw Error("@supabase/ssr: createServerClient must be initialized with cookie options that specify getAll and setAll functions (deprecated, not recommended: alternatively use get, set and remove)");else a=()=>[],r=()=>{throw Error("@supabase/ssr: createBrowserClient in non-browser runtimes (including Next.js pre-rendering mode) was not initialized cookie options that specify getAll and setAll functions (deprecated: alternatively use get, set and remove), but they were needed")};return t?{getAll:a,setAll:r,setItems:p,removedItems:m,storage:{isServer:!0,getItem:async e=>{if("string"==typeof p[e])return p[e];if(m[e])return null;let t=await a([e]),r=await d(e,async e=>{let a=t?.find(({name:t})=>t===e)||null;return a?a.value:null});if(!r)return null;let n=r;return"string"==typeof r&&r.startsWith(g)&&(n=h(r.substring(g.length))),n},setItem:async(t,n)=>{t.endsWith("-code-verifier")&&await x({getAll:a,setAll:r,setItems:{[t]:n},removedItems:{}},{cookieOptions:e?.cookieOptions??null,cookieEncoding:u}),p[t]=n,delete m[t]},removeItem:async e=>{delete p[e],m[e]=!0}}}:{getAll:a,setAll:r,setItems:p,removedItems:m,storage:{isServer:!1,getItem:async e=>{let t=await a([e]),r=await d(e,async e=>{let a=t?.find(({name:t})=>t===e)||null;return a?a.value:null});if(!r)return null;let n=r;return r.startsWith(g)&&(n=h(r.substring(g.length))),n},setItem:async(t,n)=>{let i=await a([t]),o=new Set((i?.map(({name:e})=>e)||[]).filter(e=>l(e,t))),d=n;"base64url"===u&&(d=g+f(n));let p=c(t,d);p.forEach(({name:e})=>{o.delete(e)});let m={...s,...e?.cookieOptions,maxAge:0},h={...s,...e?.cookieOptions,maxAge:s.maxAge};delete m.name,delete h.name;let x=[...[...o].map(e=>({name:e,value:"",options:m})),...p.map(({name:e,value:t})=>({name:e,value:t,options:h}))];x.length>0&&await r(x)},removeItem:async t=>{let n=await a([t]),i=(n?.map(({name:e})=>e)||[]).filter(e=>l(e,t)),o={...s,...e?.cookieOptions,maxAge:0};delete o.name,i.length>0&&await r(i.map(e=>({name:e,value:"",options:o})))}}}}({...void 0,cookieEncoding:(void 0)??"base64url"},!1),m=(0,r.createClient)(e,a,{...void 0,global:{...void 0,headers:{...void 0,"X-Client-Info":"supabase-ssr/0.8.0 createBrowserClient"}},auth:{...void 0,...null,flowType:"pkce",autoRefreshToken:i(),detectSessionInUrl:i(),persistSession:!0,storage:p,...null}});return u&&(t=m),m}("https://njtwnvfryagpyarhmymv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5qdHdudmZyeWFncHlhcmhteW12Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYwODIzMTcsImV4cCI6MjA4MTY1ODMxN30.n_BcdKM9YYixWWxiWSeQdEalqvZ4MvT8H_J10FutUbk")}e.s(["createSupabaseBrowserClient",()=>y],2410)},93587,e=>{"use strict";var t=e.i(71645),a=e.i(2410);async function r(e){let t=`HTTP ${e.status} ${e.statusText}`;try{let a=await e.text();if(!a)return t;try{let e=JSON.parse(a);return e?.error??e?.message??a??t}catch{return a}}catch{return t}}function n(e,n){let i=!!n?.canEdit,s=(0,t.useMemo)(()=>(0,a.createSupabaseBrowserClient)(),[]),[o,l]=(0,t.useState)({value:"",isLoading:!0,isSaving:!1,error:null,lastSavedAt:null}),c=(0,t.useCallback)(async()=>{if(!e)return;l(e=>({...e,isLoading:!0,error:null}));let t=`/api/encounter/quest-log?campaignId=${encodeURIComponent(e)}`,a=await fetch(t);if(!a.ok){let e=await r(a);l(t=>({...t,isLoading:!1,error:e}));return}let n=await a.json().catch(()=>({}));l(e=>({...e,value:"string"==typeof n?.body?n.body:"",lastSavedAt:n?.updated_at??null,isLoading:!1,error:null}))},[e]),d=(0,t.useCallback)(e=>{l(t=>({...t,value:e}))},[]),u=(0,t.useCallback)(async t=>{if(!e||!i)return;l(e=>({...e,isSaving:!0,error:null}));let a=await fetch("/api/encounter/quest-log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e,body:t})});if(!a.ok){let e=await r(a);l(t=>({...t,isSaving:!1,error:e}));return}let n=await a.json().catch(()=>({}));l(e=>({...e,value:"string"==typeof n?.body?n.body:e.value,lastSavedAt:n?.updated_at??e.lastSavedAt,isSaving:!1,error:null}))},[e,i]);return(0,t.useEffect)(()=>{c()},[c]),(0,t.useEffect)(()=>{if(!e)return;let t=s.channel(`questlog-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"campaign_quest_log",filter:`campaign_id=eq.${e}`},()=>{c()}).subscribe();return()=>{s.removeChannel(t)}},[e,s,c]),{state:o,setValue:d,flushSave:u,reload:c}}e.s(["useCampaignQuestLog",()=>n])},16118,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(22016),n=e.i(2410),i=e.i(93587);function s({campaignId:e}){let{state:r,setValue:n,flushSave:s}=(0,i.useCampaignQuestLog)(e,{canEdit:!0}),o=(0,a.useRef)(null);return(0,a.useEffect)(()=>(o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{s(r.value)},600),()=>clearTimeout(o.current)),[r.value,s]),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:"Quest log"}),(0,t.jsx)("div",{className:"text-[11px] text-gray-500",children:r.isLoading?"Loading…":r.isSaving?"Saving…":r.lastSavedAt?"Saved":""})]}),r.error?(0,t.jsx)("div",{className:"text-xs text-red-600 break-words",children:r.error}):null,(0,t.jsx)("textarea",{className:"w-full min-h-[260px] resize-y rounded-xl border p-2 text-sm",value:r.value,onChange:e=>n(e.target.value),placeholder:"Write the shared quest log here…"})]})}function o({campaignId:e}){let[r,n]=(0,a.useState)("quest");return(0,t.jsx)("aside",{className:"w-full lg:w-[420px] shrink-0",children:(0,t.jsxs)("div",{className:"border rounded-2xl p-3 lg:sticky lg:top-6 max-h-[calc(100vh-3rem)] overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("div",{className:"font-medium",children:"Reference"}),(0,t.jsx)("div",{className:"text-[11px] text-gray-500",children:"DM tools"})]}),(0,t.jsx)("div",{className:"mt-2 grid grid-cols-1 gap-2",children:(0,t.jsx)(l,{active:"quest"===r,onClick:()=>n("quest"),children:"Quest log"})}),(0,t.jsx)("div",{className:"mt-3 border rounded-xl p-3 overflow-y-auto max-h-[calc(100vh-10rem)]",children:"quest"===r?(0,t.jsx)(s,{campaignId:e}):null})]})})}function l({active:e,onClick:a,children:r}){return(0,t.jsx)("button",{type:"button",onClick:a,className:`px-3 py-2 rounded-xl border text-sm ${e?"bg-black text-white border-black":"hover:bg-gray-50"}`,children:r})}function c({campaignId:e}){let i=(0,a.useMemo)(()=>(0,n.createSupabaseBrowserClient)(),[]),[s,l]=(0,a.useState)(!0),[c,d]=(0,a.useState)(null),[u,p]=(0,a.useState)(null),[m,f]=(0,a.useState)(null),[h,g]=(0,a.useState)([]),[x,y]=(0,a.useState)([]),[b,v]=(0,a.useState)(""),[j,w]=(0,a.useState)({}),[N,S]=(0,a.useState)({}),[k,_]=(0,a.useState)({}),[C,O]=(0,a.useState)({}),[T,E]=(0,a.useState)({}),[A,P]=(0,a.useState)({}),[I,$]=(0,a.useState)({}),[M,q]=(0,a.useState)(!1),[U,R]=(0,a.useState)(null),[L,F]=(0,a.useState)(null),[J,B]=(0,a.useState)(!1),[D,z]=(0,a.useState)(null),W=u?.active_encounter_id??null,H=m?.turn_index??0,K=h.filter(e=>!e.is_defeated),Q=K[H],Y=Q?.character_id??null,[X,Z]=(0,a.useState)(null),[V,G]=(0,a.useState)("Enemy"),[ee,et]=(0,a.useState)(!1),[ea,er]=(0,a.useState)([]),[en,ei]=(0,a.useState)(""),[es,eo]=(0,a.useState)("all");if((0,a.useEffect)(()=>{q(!1)},[W]),!e)return(0,t.jsxs)("div",{style:{padding:16},children:[(0,t.jsx)("h1",{children:"DM Screen"}),(0,t.jsx)("div",{children:(0,t.jsx)(r.default,{href:"/app",children:"← Back to campaign"})}),(0,t.jsxs)("div",{style:{padding:12,border:"1px solid #f99",background:"#fee"},children:[(0,t.jsx)("b",{children:"Error:"})," campaignId is missing from the URL params.",(0,t.jsxs)("div",{style:{marginTop:8},children:["This usually means your folder is named ",(0,t.jsx)("code",{children:"[campaignid]"})," but the code expects"," ",(0,t.jsx)("code",{children:"[campaignId]"}),"."]})]})]});async function el(){l(!0),d(null);let{data:t,error:a}=await i.from("campaign_state").select("campaign_id, mode, active_encounter_id").eq("campaign_id",e).maybeSingle();if(a){d(a.message),l(!1);return}p(t??{campaign_id:e,mode:"exploration",active_encounter_id:null});let{data:r,error:n}=await i.from("characters").select("id, name").eq("campaign_id",e).order("created_at",{ascending:!0});if(n){d(n.message),l(!1);return}if(y(r??[]),!b&&(r?.length??0)>0&&v(r[0].id),t?.active_encounter_id){let a=t.active_encounter_id,{data:r,error:n}=await i.from("encounters").select("id, status, round_number, turn_index").eq("id",a).single();if(n){d(n.message),l(!1);return}f(r);let{data:s,error:o}=await i.from("encounter_log").select("id, created_at, kind, visibility, payload").eq("campaign_id",e).eq("encounter_id",a).order("created_at",{ascending:!1}).limit(50);if(o){d(o.message),l(!1);return}er(s??[]);let{data:c,error:u}=await i.from("encounter_combatants").select("id, kind, name, character_id, order_index, is_hidden, is_defeated, status_public, death_saves_successes, death_saves_failures").eq("campaign_id",e).eq("encounter_id",a).order("order_index",{ascending:!0,nullsFirst:!1}).order("created_at",{ascending:!0});if(u){d(u.message),l(!1);return}g(c??[]);let p={},m={};(c??[]).forEach(e=>{p[e.id]=String(e.death_saves_successes??0),m[e.id]=String(e.death_saves_failures??0)}),P(p),$(m);let h=(c??[]).map(e=>e.id),{data:x,error:y}=await i.from("encounter_combatants_private").select("combatant_id, initiative, hp_current, hp_max").in("combatant_id",h);if(y){d(y.message),l(!1);return}let b={};(c??[]).forEach(e=>{let t=(x??[]).find(t=>t.combatant_id===e.id);b[e.id]=String(t?.initiative??0)}),w(b);let v={},j={};(c??[]).forEach(e=>{let t=(x??[]).find(t=>t.combatant_id===e.id);v[e.id]=String(t?.hp_current??1),j[e.id]=String(t?.hp_max??1)}),S(v),_(j)}else f(null),g([]),er([]);l(!1)}async function ec(t){R(t),F(null),z(null),B(!0);let{data:a,error:r}=await i.from("cards").select("id,name,rules_text,image_path,structured").eq("id",t).eq("campaign_id",e).maybeSingle();if(r||!a){z(r?.message??"Card not found"),B(!1);return}let n=function(e){if(e&&"object"==typeof e)return e;if("string"==typeof e)try{let t=JSON.parse(e);return t&&"object"==typeof t?t:{}}catch{}return{}}(a.structured),s="string"==typeof a.image_path?a.image_path:null,o="string"==typeof n?.image_path?n.image_path:null,l=s??o,c=l?i.storage.from("card-images").getPublicUrl(l).data?.publicUrl??null:null;F({...a,imageUrl:c}),B(!1)}async function ed(t){let{data:a,error:r}=await i.from("encounter_log").select("id, created_at, kind, visibility, payload").eq("campaign_id",e).eq("encounter_id",t).order("created_at",{ascending:!1}).limit(50);r||er(a??[])}async function eu(t){d(null);let a=await fetch("/api/encounter/dm/combatant/set-death-saves",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e,combatantId:t,successes:A[t],failures:I[t]})}),r=await a.json().catch(()=>({}));a.ok?await el():d(r?.error??"Failed to update death saves")}async function ep(){d(null);let t=await fetch("/api/encounter/dm/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e})}),a=await t.json();t.ok?await el():d(a?.error??"Failed to start combat")}async function em(){if(d(null),!M){Z("Arm “End combat” first."),setTimeout(()=>Z(null),2500);return}let t=await fetch("/api/encounter/dm/end",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e})}),a=await t.json();t.ok?(q(!1),await el()):d(a?.error??"Failed to end combat")}async function ef(){if(d(null),!W)return void d("No active encounter. Start combat first.");let t=await fetch("/api/encounter/dm/enemy/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e,encounterId:W,name:V,isHidden:ee})}),a=await t.json();t.ok?await el():d(a?.error??"Failed to add enemy")}async function eh(t){if(d(null),!W)return;let a=await fetch("/api/encounter/dm/undo-last-action",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e,encounterId:W,characterId:t})}),r=await a.json().catch(()=>({}));a.ok?(Z("Undid last action."),setTimeout(()=>Z(null),2e3),await el()):d(r?.error??"Undo failed")}async function eg(){if(d(null),!W)return void d("No active encounter. Start combat first.");if(!b)return void d("Select a character first.");let t=await fetch("/api/encounter/dm/character/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e,encounterId:W,characterId:b})}),a=await t.json();t.ok?(a?.alreadyExists&&Z("Character already in encounter."),setTimeout(()=>Z(null),3e3),await el()):d(a?.error??"Failed to add character")}async function ex(){if(d(null),!W)return void d("No active encounter. Start combat first.");let t=await fetch("/api/encounter/dm/turn/next",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e,encounterId:W})}),a=await t.json();t.ok?await el():d(a?.error??"Failed to advance turn")}async function ey(t,a){if(d(null),!W)return void d("No active encounter. Start combat first.");let r=await fetch("/api/encounter/dm/combatant/toggle-defeated",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e,encounterId:W,combatantId:t,isDefeated:a})}),n=await r.json();r.ok?await el():d(n?.error??"Failed to update defeated")}async function eb(t,a){d(null);let r=await fetch("/api/encounter/dm/combatant/toggle-hidden",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e,combatantId:t,isHidden:a})}),n=await r.json();r.ok?await el():d(n?.error??"Failed to update hidden")}async function ev(){if(d(null),!W)return void d("No active encounter.");let t=en.trim();if(!t)return;let a=await fetch("/api/encounter/dm/log/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e,encounterId:W,visibility:es,text:t})}),r=await a.json().catch(()=>({}));a.ok?(ei(""),await el()):d(r?.error??"Failed to add log note")}async function ej(t){if(d(null),!W)return void d("No active encounter. Start combat first.");let a=j[t],r=await fetch("/api/encounter/dm/combatant/set-initiative",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e,encounterId:W,combatantId:t,initiative:a})}),n=await r.json();r.ok?await el():d(n?.error??"Failed to update initiative")}async function ew(t){d(null);let a=await fetch("/api/encounter/dm/combatant/set-hp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e,combatantId:t,hpCurrent:N[t],hpMax:k[t]})}),r=await a.json();a.ok?await el():d(r?.error??"Failed to update HP")}function eN(e){return Array.isArray(e)?e.map(e=>{if("string"==typeof e)return{label:e,remaining:1};if(e&&"object"==typeof e){let t=String(e.label??"").trim(),a=Number(e.remaining);return t?{label:t,remaining:Number.isFinite(a)?a:1}:null}return null}).filter(Boolean):[]}async function eS(t){d(null);let a=(C[t]??"").trim(),r=Number(T[t]??"1");if(!a)return void d("Status label cannot be empty.");let n=await fetch("/api/encounter/dm/combatant/status/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e,combatantId:t,label:a,duration:r})}),i=await n.json();n.ok?(O(e=>({...e,[t]:""})),E(e=>({...e,[t]:"1"})),await el()):d(i?.error??"Failed to add status")}async function ek(t,a){d(null);let r=await fetch("/api/encounter/dm/combatant/status/remove",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e,combatantId:t,label:a})}),n=await r.json();r.ok?await el():d(n?.error??"Failed to remove status")}return(0,a.useEffect)(()=>{el()},[e]),(0,a.useEffect)(()=>{if(!e)return;let t=i.channel(`dm-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"campaign_state",filter:`campaign_id=eq.${e}`},e=>{console.log("[dm realtime campaign_state]",e),el()}).on("postgres_changes",{event:"*",schema:"public",table:"encounters",filter:`campaign_id=eq.${e}`},()=>el()).on("postgres_changes",{event:"*",schema:"public",table:"encounter_combatants",filter:`campaign_id=eq.${e}`},()=>el()).on("postgres_changes",{event:"*",schema:"public",table:"encounter_combatants_private"},()=>el()).on("postgres_changes",{event:"*",schema:"public",table:"encounter_log"},e=>{console.log("[dm realtime encounter_log]",e),el()}).subscribe(e=>{console.log("[dm realtime status]",e)}),a=setInterval(()=>{W&&ed(W)},2e3);return()=>{clearInterval(a),i.removeChannel(t)}},[e,W]),(0,t.jsx)("main",{className:"p-6 pb-24",children:(0,t.jsxs)("div",{className:"max-w-6xl lg:flex gap-4",children:[(0,t.jsxs)("section",{className:"flex-1 space-y-6 min-w-0",children:[(0,t.jsxs)("header",{className:"space-y-1",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold",children:"DM Screen"}),(0,t.jsx)(r.default,{className:"underline text-sm",href:`/app/c/${e}`,children:"← Back to campaign"}),c?(0,t.jsxs)("p",{className:"text-sm text-red-600",children:["Error: ",c]}):null,X?(0,t.jsx)("p",{className:"text-sm text-red-600",children:X}):null,(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-800",children:"Campaign:"})," ",e]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-800",children:"Mode:"})," ",u?.mode??"unknown"]})]}),(0,t.jsxs)("div",{className:"flex gap-2 flex-wrap pt-2",children:[(0,t.jsx)("button",{onClick:el,disabled:s,className:"px-3 py-2 rounded-lg border hover:bg-gray-50 disabled:opacity-50",children:"Reload"}),W?(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("input",{type:"checkbox",checked:M,onChange:e=>q(e.target.checked)}),(0,t.jsx)("span",{className:"font-medium",children:"Arm “End combat”"})]}),(0,t.jsx)("button",{onClick:em,disabled:s||!M,className:"px-3 py-2 rounded-lg border bg-black text-white hover:opacity-90 disabled:opacity-50",title:M?"End combat":"Enable the toggle to avoid accidental clicks",children:"End Combat (Back to Exploration)"})]}):(0,t.jsx)("button",{onClick:ep,disabled:s,className:"px-3 py-2 rounded-lg border bg-black text-white hover:opacity-90 disabled:opacity-50",children:"Start Combat"})]})]}),W?(0,t.jsxs)("section",{className:"border rounded-xl p-4 space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsx)("span",{className:"font-medium",children:"Active encounter:"})," ",W]}),(0,t.jsxs)("div",{className:"flex gap-4 flex-wrap text-sm text-gray-600",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-800",children:"Round:"})," ",m?.round_number??"?"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-800",children:"Turn index:"})," ",m?.turn_index??"?"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-800",children:"Status:"})," ",m?.status??"?"]})]}),(0,t.jsxs)("div",{className:"flex gap-2 flex-wrap pt-2",children:[(0,t.jsx)("button",{onClick:ex,disabled:s,className:"px-3 py-2 rounded-lg border bg-black text-white hover:opacity-90 disabled:opacity-50",children:"Next Turn"}),(0,t.jsx)("button",{onClick:()=>{if(!Y){Z("No current player character to undo."),setTimeout(()=>Z(null),2e3);return}eh(Y)},disabled:s||!Y,className:"px-3 py-2 rounded-lg border border-red-300 text-red-700 hover:bg-red-50 disabled:opacity-50",title:Y?"Undo last draw/play/discard for the current player":"Current combatant is not a player character",children:"Undo last action"})]})]}),(0,t.jsxs)("div",{className:"border rounded-xl p-4 space-y-3",children:[(0,t.jsx)("h2",{className:"font-medium",children:"Add enemy"}),(0,t.jsxs)("div",{className:"flex gap-2 items-center flex-wrap",children:[(0,t.jsx)("input",{value:V,onChange:e=>G(e.target.value),placeholder:"Enemy name",className:"px-3 py-2 border rounded-lg w-64"}),(0,t.jsxs)("label",{className:"flex gap-2 items-center text-sm",children:[(0,t.jsx)("input",{type:"checkbox",checked:ee,onChange:e=>et(e.target.checked)}),"Start hidden"]}),(0,t.jsx)("button",{onClick:ef,disabled:s,className:"px-3 py-2 rounded-lg border bg-black text-white hover:opacity-90 disabled:opacity-50",children:"Add Enemy"})]}),(0,t.jsxs)("div",{className:"border rounded-xl p-4 space-y-3",children:[(0,t.jsx)("h2",{className:"font-medium",children:"Add character"}),0===x.length?(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"No characters found in this campaign."}):(0,t.jsxs)("div",{className:"flex gap-2 items-center flex-wrap",children:[(0,t.jsx)("select",{value:b,onChange:e=>v(e.target.value),className:"px-3 py-2 border rounded-lg",children:x.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name??e.id},e.id))}),(0,t.jsx)("button",{onClick:eg,disabled:s,className:"px-3 py-2 rounded-lg border bg-black text-white hover:opacity-90 disabled:opacity-50",children:"Add Character"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("h2",{className:"font-medium",children:["Combatants (",h.length,")"]}),0===h.length?(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"No combatants yet."}):(0,t.jsx)("ul",{className:"space-y-2",children:h.map(e=>{let a=K.findIndex(t=>t.id===e.id),r=a===H&&-1!==a;return(0,t.jsx)("li",{className:`border rounded-lg p-3 ${r?"border-yellow-300":""} ${e.is_defeated?"opacity-60":""}`,children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"font-medium",children:[r?"⭐ ":"",e.name??"(no name)"]}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["kind: ",e.kind," · hidden: ",String(e.is_hidden)," · defeated:"," ",String(e.is_defeated)]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("label",{className:"text-xs text-gray-600",children:"Initiative"}),(0,t.jsx)("input",{value:j[e.id]??"0",onChange:t=>w(a=>({...a,[e.id]:t.target.value})),className:"px-2 py-1 border rounded-md w-20",inputMode:"numeric"}),(0,t.jsx)("button",{onClick:()=>ej(e.id),disabled:s,className:"px-3 py-2 rounded-lg border hover:bg-gray-50 disabled:opacity-50",children:"Save"})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,t.jsx)("button",{onClick:()=>ey(e.id,!e.is_defeated),disabled:s,className:"px-3 py-2 rounded-lg border hover:bg-gray-50 disabled:opacity-50",children:e.is_defeated?"Undo Defeated":"Mark Defeated"}),"enemy"===e.kind||"npc"===e.kind?(0,t.jsx)("button",{onClick:()=>eb(e.id,!e.is_hidden),disabled:s,className:"px-3 py-2 rounded-lg border hover:bg-gray-50 disabled:opacity-50",children:e.is_hidden?"Reveal":"Hide"}):null]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"text-xs text-gray-600",children:"Statuses"}),(0,t.jsx)("div",{className:"flex gap-2 flex-wrap",children:0===eN(e.status_public).length?(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"None"}):eN(e.status_public).map(a=>(0,t.jsxs)("span",{className:"inline-flex items-center gap-2 border rounded-full px-3 py-1 text-sm",children:[(0,t.jsxs)("span",{children:[a.label," (",a.remaining,")"]}),(0,t.jsx)("button",{onClick:()=>ek(e.id,a.label),disabled:s,className:"text-sm underline disabled:opacity-50",title:"Remove",children:"x"})]},a.label))}),(0,t.jsxs)("div",{className:"flex gap-2 items-center flex-wrap",children:[(0,t.jsx)("input",{value:C[e.id]??"",onChange:t=>O(a=>({...a,[e.id]:t.target.value})),placeholder:"e.g. stunned",className:"px-3 py-2 border rounded-lg w-56"}),(0,t.jsx)("input",{value:T[e.id]??"1",onChange:t=>E(a=>({...a,[e.id]:t.target.value})),placeholder:"turns",className:"px-3 py-2 border rounded-lg w-24",inputMode:"numeric"}),(0,t.jsx)("button",{onClick:()=>eS(e.id),disabled:s,className:"px-3 py-2 rounded-lg border hover:bg-gray-50 disabled:opacity-50",children:"Add"})]})]}),"enemy"===e.kind||"npc"===e.kind?(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("label",{className:"text-xs text-gray-600",children:"HP"}),(0,t.jsx)("input",{value:N[e.id]??"1",onChange:t=>S(a=>({...a,[e.id]:t.target.value})),className:"px-2 py-1 border rounded-md w-20",inputMode:"numeric",placeholder:"cur"}),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"/"}),(0,t.jsx)("input",{value:k[e.id]??"1",onChange:t=>_(a=>({...a,[e.id]:t.target.value})),className:"px-2 py-1 border rounded-md w-20",inputMode:"numeric",placeholder:"max"}),(0,t.jsx)("button",{onClick:()=>ew(e.id),disabled:s,className:"px-3 py-2 rounded-lg border hover:bg-gray-50 disabled:opacity-50",children:"Save HP"})]}):(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Player HP is controlled by the player."}),"character"===e.kind?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"text-xs text-gray-600",children:"Death saves"}),(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,t.jsx)("label",{className:"text-xs text-gray-600",children:"Success"}),(0,t.jsxs)("select",{className:"px-2 py-1 border rounded-md",value:A[e.id]??"0",onChange:t=>P(a=>({...a,[e.id]:t.target.value})),children:[(0,t.jsx)("option",{value:"0",children:"0"}),(0,t.jsx)("option",{value:"1",children:"1"}),(0,t.jsx)("option",{value:"2",children:"2"}),(0,t.jsx)("option",{value:"3",children:"3"})]}),(0,t.jsx)("label",{className:"text-xs text-gray-600",children:"Fail"}),(0,t.jsxs)("select",{className:"px-2 py-1 border rounded-md",value:I[e.id]??"0",onChange:t=>$(a=>({...a,[e.id]:t.target.value})),children:[(0,t.jsx)("option",{value:"0",children:"0"}),(0,t.jsx)("option",{value:"1",children:"1"}),(0,t.jsx)("option",{value:"2",children:"2"}),(0,t.jsx)("option",{value:"3",children:"3"})]}),(0,t.jsx)("button",{onClick:()=>eu(e.id),disabled:s,className:"px-3 py-2 rounded-lg border hover:bg-gray-50 disabled:opacity-50",children:"Save"})]})]}):null]})]})},e.id)})})]}),(0,t.jsxs)("section",{className:"border rounded-xl p-4 space-y-3",children:[(0,t.jsx)("h2",{className:"font-medium",children:"Encounter log"}),(0,t.jsxs)("div",{className:"flex gap-2 flex-wrap items-center",children:[(0,t.jsxs)("select",{value:es,onChange:e=>eo("dm"===e.target.value?"dm":"all"),className:"px-3 py-2 rounded-lg border",children:[(0,t.jsx)("option",{value:"all",children:"Public"}),(0,t.jsx)("option",{value:"dm",children:"DM only"})]}),(0,t.jsx)("input",{value:en,onChange:e=>ei(e.target.value),placeholder:"Write a note...",className:"px-3 py-2 rounded-lg border flex-1 min-w-[240px]"}),(0,t.jsx)("button",{type:"button",onClick:ev,disabled:s,className:"px-3 py-2 rounded-lg border hover:bg-gray-50 disabled:opacity-50",children:"Add note"})]}),0===ea.length?(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"No log entries yet."}):(0,t.jsx)("ul",{className:"space-y-2",children:ea.map(e=>{let a=e.payload??{},r="";if("note"===e.kind)r=String(a.text??"");else if("card"===e.kind){let e=a.action,t=a.card_name??"(card)",n=a.character_name??"Someone";r=`${n} ${"play"===e?"played":"discarded"} ${t}`}else r=`${e.kind??"log"} entry`;let n="card"===e.kind,i=a?.action,s=a?.character_name??"Someone",o=a?.card_name??"(card)",l="string"==typeof a?.card_id?a.card_id:"";return(0,t.jsx)("li",{className:"text-sm",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[(0,t.jsx)("div",{children:n?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{children:[s," "]}),(0,t.jsxs)("span",{children:["play"===i?"played":"discarded"," "]}),(0,t.jsx)("button",{type:"button",className:"underline",onClick:()=>{l&&ec(l)},children:o})]}):(0,t.jsx)(t.Fragment,{children:r})}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["dm"===e.visibility?"DM":"Public"," ·"," ",new Date(e.created_at).toLocaleString()]})]})},e.id)})})]})]}):(0,t.jsx)("section",{className:"border rounded-xl p-4 space-y-2",children:(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"No active encounter."})}),U&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center p-4",onClick:()=>{R(null),F(null),z(null)},children:(0,t.jsxs)("div",{className:"bg-white text-black w-full max-w-3xl rounded-2xl p-4 space-y-3",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xl font-semibold",children:L?.name??(J?"Loading…":"Card")}),D?(0,t.jsx)("div",{className:"text-sm text-red-600",children:D}):null]}),(0,t.jsx)("button",{className:"border rounded-md px-3 py-2",onClick:()=>{R(null),F(null),z(null)},children:"Close"})]}),J?(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Loading…"}):L?(0,t.jsxs)(t.Fragment,{children:[L.imageUrl?(0,t.jsx)("img",{src:L.imageUrl,alt:L.name??"Card",className:"w-full max-h-[420px] object-contain rounded-lg border bg-white"}):(0,t.jsx)("div",{className:"w-full h-[220px] rounded-lg border bg-gray-50 grid place-items-center text-sm text-gray-500",children:"No image"}),(0,t.jsx)("div",{className:"max-h-[45vh] overflow-y-auto pr-1",children:(0,t.jsx)("div",{className:"text-sm whitespace-pre-wrap text-gray-800",children:L.rules_text??""})})]}):null]})})]}),(0,t.jsx)(o,{campaignId:e})]})})}e.s(["default",()=>c],16118)}]);