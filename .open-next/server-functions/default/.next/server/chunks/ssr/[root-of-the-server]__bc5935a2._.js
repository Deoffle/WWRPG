module.exports=[42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},39118,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DEFAULT_SEGMENT_KEY:function(){return l},NOT_FOUND_SEGMENT_KEY:function(){return m},PAGE_SEGMENT_KEY:function(){return k},addSearchParamsIfPageSegment:function(){return i},computeSelectedLayoutSegment:function(){return j},getSegmentValue:function(){return f},getSelectedLayoutSegmentPath:function(){return function a(b,c,d=!0,e=[]){let g;if(d)g=b[1][c];else{let a=b[1];g=a.children??Object.values(a)[0]}if(!g)return e;let h=f(g[0]);return!h||h.startsWith(k)?e:(e.push(h),a(g,c,!1,e))}},isGroupSegment:function(){return g},isParallelRouteSegment:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){return Array.isArray(a)?a[1]:a}function g(a){return"("===a[0]&&a.endsWith(")")}function h(a){return a.startsWith("@")&&"@children"!==a}function i(a,b){if(a.includes(k)){let a=JSON.stringify(b);return"{}"!==a?k+"?"+a:k}return a}function j(a,b){if(!a||0===a.length)return null;let c="children"===b?a[0]:a[a.length-1];return c===l?null:c}let k="__PAGE__",l="__DEFAULT__",m="/_not-found"},46058,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},8591,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"useMergedRef",{enumerable:!0,get:function(){return e}});let d=a.r(72131);function e(a,b){let c=(0,d.useRef)(null),e=(0,d.useRef)(null);return(0,d.useCallback)(d=>{if(null===d){let a=c.current;a&&(c.current=null,a());let b=e.current;b&&(e.current=null,b())}else a&&(c.current=f(a,d)),b&&(e.current=f(b,d))},[a,b])}function f(a,b){if("function"!=typeof a)return a.current=b,()=>{a.current=null};{let c=a(b);return"function"==typeof c?c:()=>a(null)}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},92434,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"warnOnce",{enumerable:!0,get:function(){return d}});let d=a=>{}},68063,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={getDeploymentId:function(){return f},getDeploymentIdQueryOrEmptyString:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(){return!1}function g(){return""}},9790,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);function e({campaignId:a}){if(!a)return(0,b.jsx)("p",{className:"text-sm text-red-600",children:"DEBUG: campaignId prop is missing"});let e=(0,d.useRouter)(),[f,g]=(0,c.useState)(""),[h,i]=(0,c.useState)("common"),[j,k]=(0,c.useState)("both"),[l,m]=(0,c.useState)("1"),[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)(!1);async function x(b){if(!r)return{imagePath:null};let c=new FormData;c.append("campaignId",a),c.append("cardId",b),c.append("file",r);let d=await fetch("/api/cards/upload-image",{method:"POST",body:c}),e=await d.json().catch(()=>({}));if(!d.ok)throw Error(e?.error??"Upload failed");return{imagePath:e.imagePath}}async function y(b){b.preventDefault(),u(null);let c=f.trim();if(!c)return u("Enter a card name.");let d=n.split(",").map(a=>a.trim()).filter(Boolean);w(!0);let t=await fetch("/api/cards/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:a,name:c,tags:d,structured:{rarity:h,encounter_type:j,description:p,max_owned:function(a,b=0){let c=Number(a);return Number.isFinite(c)?Math.trunc(c):b}(l,1),image_path:null}})}),v=await t.json().catch(()=>({}));if(!t.ok)return w(!1),u(v?.error??"Failed to create card.");let y=String(v?.id||"");if(!y)return w(!1),u("Card created but no id returned.");try{if(r){let{imagePath:b}=await x(y);await fetch("/api/cards/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:a,cardId:y,name:c,tags:d,structuredPatch:{image_path:b}})})}}catch(a){u(`Card created, but image upload failed: ${a?.message??"Unknown error"}`)}w(!1),g(""),i("common"),k("both"),m("1"),o(""),q(""),s(null),e.refresh()}return(0,b.jsxs)("form",{onSubmit:y,className:"space-y-3",children:[(0,b.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2",children:[(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Name"}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",value:f,onChange:a=>g(a.target.value)})]}),(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Rarity"}),(0,b.jsxs)("select",{className:"border rounded-md p-2 w-full",value:h,onChange:a=>i(a.target.value),children:[(0,b.jsx)("option",{value:"legendary",children:"Legendary"}),(0,b.jsx)("option",{value:"epic",children:"Epic"}),(0,b.jsx)("option",{value:"rare",children:"Rare"}),(0,b.jsx)("option",{value:"common",children:"Common"})]})]}),(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Encounter type"}),(0,b.jsxs)("select",{className:"border rounded-md p-2 w-full",value:j,onChange:a=>k(a.target.value),children:[(0,b.jsx)("option",{value:"both",children:"Both"}),(0,b.jsx)("option",{value:"combat",children:"Combat"}),(0,b.jsx)("option",{value:"exploration",children:"Exploration"})]})]}),(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Max owned"}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",value:l,onChange:a=>m(a.target.value),inputMode:"numeric"})]})]}),(0,b.jsxs)("label",{className:"space-y-1 block",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Tags (comma-separated)"}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",value:n,onChange:a=>o(a.target.value)})]}),(0,b.jsxs)("label",{className:"space-y-1 block",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Description"}),(0,b.jsx)("textarea",{className:"border rounded-md p-2 w-full",rows:3,value:p,onChange:a=>q(a.target.value)})]}),(0,b.jsxs)("label",{className:"block space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Card image (optional)"}),(0,b.jsx)("input",{type:"file",accept:"image/*",onChange:a=>s(a.target.files?.[0]??null)}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"Recommended aspect ratio: 785×1100."})]}),t&&(0,b.jsx)("p",{className:"text-sm text-red-600",children:t}),(0,b.jsx)("button",{className:"border rounded-md px-3 py-2",disabled:v,children:v?"Creating…":"Create card"}),(0,b.jsxs)("p",{className:"text-xs text-gray-600",children:["Note: this saves card fields into ",(0,b.jsx)("span",{className:"font-medium",children:"cards.structured"}),"."]})]})}a.s(["default",()=>e])},74756,a=>{"use strict";var b=a.i(87924),c=a.i(38246),d=a.i(72131);let e={legendary:0,epic:1,rare:2,common:3};function f({campaignId:a,cards:f}){let[g,h]=(0,d.useState)(""),[i,j]=(0,d.useState)("all"),[k,l]=(0,d.useState)("all"),m=(0,d.useMemo)(()=>{let a=g.trim().toLowerCase(),b=f;return"all"!==i&&(b=b.filter(a=>a.rarity===i)),"all"!==k&&(b=b.filter(a=>a.encounter_type===k)),a&&(b=b.filter(b=>`${b.name} ${b.rarity} ${b.encounter_type} ${b.tags.join(" ")}`.toLowerCase().includes(a))),b.slice().sort((a,b)=>{let c=e[a.rarity],d=e[b.rarity];return c!==d?c-d:a.name.localeCompare(b.name)})},[f,g,i,k]);return(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"grid gap-2 sm:grid-cols-3",children:[(0,b.jsx)("input",{className:"border rounded-md p-2 sm:col-span-2",placeholder:"Search by name/tag…",value:g,onChange:a=>h(a.target.value)}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)("select",{className:"border rounded-md p-2",value:i,onChange:a=>j(a.target.value),children:[(0,b.jsx)("option",{value:"all",children:"All rarities"}),(0,b.jsx)("option",{value:"legendary",children:"Legendary"}),(0,b.jsx)("option",{value:"epic",children:"Epic"}),(0,b.jsx)("option",{value:"rare",children:"Rare"}),(0,b.jsx)("option",{value:"common",children:"Common"})]}),(0,b.jsxs)("select",{className:"border rounded-md p-2",value:k,onChange:a=>l(a.target.value),children:[(0,b.jsx)("option",{value:"all",children:"All types"}),(0,b.jsx)("option",{value:"combat",children:"Combat"}),(0,b.jsx)("option",{value:"exploration",children:"Exploration"}),(0,b.jsx)("option",{value:"both",children:"Both"})]})]})]}),(0,b.jsx)("div",{className:"grid gap-3 grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5",children:m.map(d=>{var e;return(0,b.jsxs)(c.default,{href:`/app/c/${a}/cards/${d.id}`,className:"border rounded-xl p-2 hover:bg-gray-50",children:[d.image_url?(0,b.jsx)("img",{src:d.image_url,alt:d.name,className:"w-full h-auto rounded-lg border",loading:"lazy"}):(0,b.jsx)("div",{className:"w-full aspect-[785/1100] rounded-lg border bg-gray-50 grid place-items-center text-xs text-gray-500",children:"No image"}),(0,b.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,b.jsx)("div",{className:"font-medium text-sm leading-tight",children:d.name}),(0,b.jsxs)("div",{className:"text-xs text-gray-600",children:[(e=d.rarity).charAt(0).toUpperCase()+e.slice(1)," • ",d.encounter_type," • max ",d.max_owned]}),d.tags.length?(0,b.jsxs)("div",{className:"text-[11px] text-gray-500 truncate",children:["Tags: ",d.tags.join(", ")]}):null]})]},d.id)})})]})}a.s(["default",()=>f])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__bc5935a2._.js.map