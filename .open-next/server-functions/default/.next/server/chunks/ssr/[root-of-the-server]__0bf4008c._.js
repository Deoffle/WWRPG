module.exports=[42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},39118,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DEFAULT_SEGMENT_KEY:function(){return l},NOT_FOUND_SEGMENT_KEY:function(){return m},PAGE_SEGMENT_KEY:function(){return k},addSearchParamsIfPageSegment:function(){return i},computeSelectedLayoutSegment:function(){return j},getSegmentValue:function(){return f},getSelectedLayoutSegmentPath:function(){return function a(b,c,d=!0,e=[]){let g;if(d)g=b[1][c];else{let a=b[1];g=a.children??Object.values(a)[0]}if(!g)return e;let h=f(g[0]);return!h||h.startsWith(k)?e:(e.push(h),a(g,c,!1,e))}},isGroupSegment:function(){return g},isParallelRouteSegment:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){return Array.isArray(a)?a[1]:a}function g(a){return"("===a[0]&&a.endsWith(")")}function h(a){return a.startsWith("@")&&"@children"!==a}function i(a,b){if(a.includes(k)){let a=JSON.stringify(b);return"{}"!==a?k+"?"+a:k}return a}function j(a,b){if(!a||0===a.length)return null;let c="children"===b?a[0]:a[a.length-1];return c===l?null:c}let k="__PAGE__",l="__DEFAULT__",m="/_not-found"},46058,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},8591,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"useMergedRef",{enumerable:!0,get:function(){return e}});let d=a.r(72131);function e(a,b){let c=(0,d.useRef)(null),e=(0,d.useRef)(null);return(0,d.useCallback)(d=>{if(null===d){let a=c.current;a&&(c.current=null,a());let b=e.current;b&&(e.current=null,b())}else a&&(c.current=f(a,d)),b&&(e.current=f(b,d))},[a,b])}function f(a,b){if("function"!=typeof a)return a.current=b,()=>{a.current=null};{let c=a(b);return"function"==typeof c?c:()=>a(null)}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},92434,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"warnOnce",{enumerable:!0,get:function(){return d}});let d=a=>{}},68063,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={getDeploymentId:function(){return f},getDeploymentIdQueryOrEmptyString:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(){return!1}function g(){return""}},32439,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(83160);function f({campaignId:a,card:f}){let g=(0,d.useRouter)(),h=function(a){if(a&&"object"==typeof a)return a;if("string"==typeof a)try{let b=JSON.parse(a);return b&&"object"==typeof b?b:{}}catch{}return{}}(f?.structured),[i,j]=(0,c.useState)(f?.name??""),[k,l]=(0,c.useState)(h?.rarity??"common"),[m,n]=(0,c.useState)(h?.encounter_type??"both"),[o,p]=(0,c.useState)(String(h?.max_owned??1)),[q,r]=(0,c.useState)((Array.isArray(f?.tags)?f.tags:[]).join(", ")),[s,t]=(0,c.useState)(h?.description??""),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(null);async function A(b){if(!u)return{imagePath:null};let c=(u.name.split(".").pop()||"png").toLowerCase(),d=`${a}/${b}-${Date.now()}-${u.name.toLowerCase().replace(/[^a-z0-9._-]+/g,"-").slice(0,80)||"card"}.${c}`,f=(0,e.createClient)("https://njtwnvfryagpyarhmymv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5qdHdudmZyeWFncHlhcmhteW12Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYwODIzMTcsImV4cCI6MjA4MTY1ODMxN30.n_BcdKM9YYixWWxiWSeQdEalqvZ4MvT8H_J10FutUbk"),{error:g}=await f.storage.from("card-images").upload(d,u,{upsert:!0,contentType:u.type||"image/png",cacheControl:"3600"});if(g)throw g;return{imagePath:d}}async function B(){z(null),x(!0);let b=i.trim();if(!b)return x(!1),z("Name is required.");let c=q.split(",").map(a=>a.trim()).filter(Boolean),d={};try{if(u){let{imagePath:a}=await A(f.id);d={image_path:a}}}catch(a){return x(!1),z(`Image upload failed: ${a?.message??"Unknown error"}`)}let e=await fetch("/api/cards/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:a,cardId:f.id,name:b,tags:c,structuredPatch:{rarity:k,encounter_type:m,description:s,max_owned:function(a,b=0){let c=Number(a);return Number.isFinite(c)?Math.trunc(c):b}(o,1),...d}})}),h=await e.json().catch(()=>({}));if(x(!1),!e.ok)return z(h?.error??"Failed to save card.");v(null),g.refresh()}return(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2",children:[(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Name"}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",value:i,onChange:a=>j(a.target.value)})]}),(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Rarity"}),(0,b.jsxs)("select",{className:"border rounded-md p-2 w-full",value:k,onChange:a=>l(a.target.value),children:[(0,b.jsx)("option",{value:"legendary",children:"Legendary"}),(0,b.jsx)("option",{value:"epic",children:"Epic"}),(0,b.jsx)("option",{value:"rare",children:"Rare"}),(0,b.jsx)("option",{value:"common",children:"Common"})]})]}),(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Encounter type"}),(0,b.jsxs)("select",{className:"border rounded-md p-2 w-full",value:m,onChange:a=>n(a.target.value),children:[(0,b.jsx)("option",{value:"both",children:"Both"}),(0,b.jsx)("option",{value:"combat",children:"Combat"}),(0,b.jsx)("option",{value:"exploration",children:"Exploration"})]})]}),(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Max owned"}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",value:o,onChange:a=>p(a.target.value),inputMode:"numeric"})]})]}),(0,b.jsxs)("label",{className:"space-y-1 block",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Tags (comma-separated)"}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",value:q,onChange:a=>r(a.target.value)})]}),(0,b.jsxs)("label",{className:"space-y-1 block",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Description"}),(0,b.jsx)("textarea",{className:"border rounded-md p-2 w-full",rows:3,value:s,onChange:a=>t(a.target.value)})]}),(0,b.jsxs)("label",{className:"block space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Replace image (optional)"}),(0,b.jsx)("input",{type:"file",accept:"image/*",onChange:a=>v(a.target.files?.[0]??null)}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"Recommended aspect ratio: 785×1100."})]}),y?(0,b.jsx)("p",{className:"text-sm text-red-600",children:y}):null,(0,b.jsx)("button",{className:"border rounded-md px-3 py-2 disabled:opacity-50",type:"button",disabled:w,onClick:B,children:w?"Saving…":"Save"}),(0,b.jsxs)("p",{className:"text-xs text-gray-600",children:["Note: this saves your new card fields into ",(0,b.jsx)("span",{className:"font-medium",children:"cards.structured"}),"."]})]})}a.s(["default",()=>f])},58530,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);function e(a,b=0){let c=Number(a);return Number.isFinite(c)?Math.trunc(c):b}function f({campaignId:a,cardId:f,characters:g,initialByCharacter:h,structured:i}){let j=(0,d.useRouter)(),[k,l]=(0,c.useState)(g[0]?.id??""),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(null),q=(0,c.useMemo)(()=>{let a=function(a){if(a&&"object"==typeof a)return a;if("string"==typeof a)try{let b=JSON.parse(a);return b&&"object"==typeof b?b:{}}catch{}return{}}(i);return"combat"===a.encounter_type||"exploration"===a.encounter_type||"both"===a.encounter_type?a.encounter_type:"both"},[i]),r=h[k]??{combat:0,exploration:0},[s,t]=(0,c.useState)(String(r.combat)),[u,v]=(0,c.useState)(String(r.exploration));async function w(){p(null),n(!0);let b=await fetch("/api/cards/push",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:a,cardId:f,characterId:k,combatQty:Math.max(0,e(s,0)),explorationQty:Math.max(0,e(u,0))})}),c=await b.json().catch(()=>({}));(n(!1),b.ok)?j.refresh():p(c?.error??"Failed to push card.")}let x="combat"===q||"both"===q,y="exploration"===q||"both"===q;return(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2",children:[(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Character"}),(0,b.jsxs)("select",{className:"border rounded-md p-2 w-full",value:k,onChange:a=>{var b;let c;return l(b=a.target.value),void(t(String((c=h[b]??{combat:0,exploration:0}).combat)),v(String(c.exploration)),p(null))},children:[0===g.length?(0,b.jsx)("option",{value:"",children:"No characters"}):null,g.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{className:"text-xs text-gray-600 flex items-end",children:["Encounter type: ",(0,b.jsx)("span",{className:"ml-2 font-medium",children:q})]})]}),(0,b.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[x?(0,b.jsxs)("div",{className:"border rounded-lg p-3 space-y-2",children:[(0,b.jsx)("div",{className:"font-medium",children:"Combat deck"}),(0,b.jsxs)("label",{className:"flex items-center gap-2 select-none text-sm",children:[(0,b.jsx)("input",{type:"checkbox",checked:Math.max(0,e(s,0))>0,onChange:a=>t(a.target.checked?"1":"0"),disabled:m}),"Enabled"]}),(0,b.jsxs)("label",{className:"space-y-1 block",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Quantity"}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",inputMode:"numeric",value:s,onChange:a=>t(a.target.value),disabled:m})]}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"0 = not pushed"})]}):(0,b.jsxs)("div",{className:"border rounded-lg p-3 text-sm text-gray-500",children:["Combat push disabled (card is ",q," only)."]}),y?(0,b.jsxs)("div",{className:"border rounded-lg p-3 space-y-2",children:[(0,b.jsx)("div",{className:"font-medium",children:"Exploration deck"}),(0,b.jsxs)("label",{className:"flex items-center gap-2 select-none text-sm",children:[(0,b.jsx)("input",{type:"checkbox",checked:Math.max(0,e(u,0))>0,onChange:a=>v(a.target.checked?"1":"0"),disabled:m}),"Enabled"]}),(0,b.jsxs)("label",{className:"space-y-1 block",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Quantity"}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",inputMode:"numeric",value:u,onChange:a=>v(a.target.value),disabled:m})]}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"0 = not pushed"})]}):(0,b.jsxs)("div",{className:"border rounded-lg p-3 text-sm text-gray-500",children:["Exploration push disabled (card is ",q," only)."]})]}),o?(0,b.jsx)("p",{className:"text-sm text-red-600",children:o}):null,(0,b.jsx)("button",{type:"button",onClick:w,disabled:m||!k,className:"border rounded-md px-3 py-2 disabled:opacity-50",children:m?"Saving…":"Save push settings"}),(0,b.jsx)("p",{className:"text-xs text-gray-600",children:"Setting quantity to 0 removes the card from that character’s deck."})]})}a.s(["default",()=>f])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__0bf4008c._.js.map