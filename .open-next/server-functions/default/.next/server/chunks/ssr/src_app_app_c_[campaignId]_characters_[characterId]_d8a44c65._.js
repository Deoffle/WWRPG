module.exports=[71080,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);let e=["physical","mental","magic","intelligence","diplomacy","incivility"],f=[{key:"acrobatics",label:"Acrobatics",ability:"physical"},{key:"athletics",label:"Athletics",ability:"physical"},{key:"communication",label:"Communication",ability:"diplomacy"},{key:"deception",label:"Deception",ability:"incivility"},{key:"history",label:"History",ability:"intelligence"},{key:"identification",label:"Identification",ability:"magic"},{key:"insight",label:"Insight",ability:"diplomacy"},{key:"intimidation",label:"Intimidation",ability:"incivility"},{key:"investigation",label:"Investigation",ability:"intelligence"},{key:"learning",label:"Learning",ability:"mental"},{key:"perception",label:"Perception",ability:"mental"},{key:"performance",label:"Performance",ability:"incivility"},{key:"persuasion",label:"Persuasion",ability:"diplomacy"},{key:"sleight_of_hand",label:"Sleight of Hand",ability:"physical"},{key:"spells",label:"Spells",ability:"magic"}],g=[{key:"hpMax",label:"Max HP"},{key:"ac",label:"AC"},{key:"initiative",label:"Initiative"},{key:"speed",label:"Speed"},{key:"passivePerception",label:"Passive perception"}],h=["main_hand","offhand","head","body","hands","legs","feet","accessory"];function i(){return Math.random().toString(16).slice(2)+"-"+Date.now().toString(16)}function j(a,b=0){let c=Number(a);return Number.isFinite(c)?Math.trunc(c):b}function k(a){switch(a){case"main_hand":return"Main hand";case"offhand":return"Offhand";case"head":return"Head";case"body":return"Body";case"hands":return"Hands";case"legs":return"Legs";case"feet":return"Feet";case"accessory":return"Accessory"}}function l(a){return a>=0?`+${a}`:`${a}`}function m(a){if("equipment"!==a.kind){let{slot:b,equipped:c,modifiers:d,...e}=a;return e}return{...a,slot:a.slot??"main_hand",equipped:!!a.equipped&&(a.qty??0)>0,modifiers:a.modifiers??{}}}function n(a){let b=a.map(m);for(let a of b)"equipment"===a.kind&&(a.qty??0)<=0&&a.equipped&&(a.equipped=!1);let c=new Map;for(let a of b){if("equipment"!==a.kind)continue;let b=a.slot??"main_hand";c.has(b)||c.set(b,[]),c.get(b).push(a)}for(let[a,b]of c.entries()){let c=b.filter(a=>a.equipped),d="accessory"===a?2:1;if(c.length<=d)continue;let e=0;for(let a of b)a.equipped&&(e<d?e++:a.equipped=!1)}return b}function o({campaignId:a,characterId:m,initialItems:o}){let p=(0,d.useRouter)(),[q,r]=(0,c.useState)(()=>n(function(a){if(!Array.isArray(a))return[];let b=[];for(let c of a){if(!c||"object"!=typeof c)continue;let a=c.kind;if("equipment"===a||"consumable"===a||"key"===a||"other"===a){let d="string"==typeof c.id?c.id:i(),e="string"==typeof c.name?c.name:"(unnamed)",f=Number.isFinite(Number(c.qty))?Math.max(0,Math.trunc(Number(c.qty))):1,g={id:d,kind:a,name:e,qty:f,description:"string"==typeof c.description?c.description:""};"equipment"===a&&(g.slot="string"==typeof c.slot?c.slot:"main_hand",g.equipped=!!c.equipped&&f>0,g.modifiers=c.modifiers&&"object"==typeof c.modifiers?c.modifiers:{}),b.push(g);continue}let d="string"==typeof c.id?c.id:i(),e="string"==typeof c.name?c.name:"(unnamed)",f=Number.isFinite(Number(c.qty))?Math.max(0,Math.trunc(Number(c.qty))):1,g="string"==typeof c.notes?c.notes:"";b.push({id:d,kind:"other",name:e,qty:f,description:g})}return b}(o))),[s,t]=(0,c.useState)("equipment"),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)("1"),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)("main_hand"),[C,D]=(0,c.useState)(()=>Object.fromEntries(e.map(a=>[a,"0"]))),[E,F]=(0,c.useState)(()=>Object.fromEntries(e.map(a=>[a,"0"]))),[G,H]=(0,c.useState)(()=>Object.fromEntries(f.map(a=>[a.key,"0"]))),[I,J]=(0,c.useState)(()=>Object.fromEntries(g.map(a=>[a.key,"0"]))),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(null),O=(0,c.useMemo)(()=>{let a=q.filter(a=>"equipment"===a.kind),b=q.filter(a=>"consumable"===a.kind);return{eq:a,con:b,key:q.filter(a=>"key"===a.kind),oth:q.filter(a=>"other"===a.kind)}},[q]),P=(0,c.useMemo)(()=>{let a=new Map;for(let b of h)a.set(b,[]);for(let b of O.eq){let c=b.slot??"main_hand";a.get(c)?.push(b)}return a},[O.eq]);async function Q(b){N(null),L(!0);let c=n(b),d=await fetch("/api/characters/items/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:a,characterId:m,items:c})}),e=await d.json().catch(()=>({}));return(L(!1),d.ok)?(r(c),p.refresh(),!0):(N(e?.error??"Failed to save items."),!1)}async function R(a){a.preventDefault();let b=u.trim();if(!b)return N("Enter an item name.");let c=Math.max(0,Math.trunc(Number(w)));if(!Number.isFinite(Number(w))||!Number.isInteger(Number(w))||c<0)return N("Quantity must be a whole number ≥ 0.");let d={id:i(),kind:s,name:b,qty:"key"===s?1:c,description:y.trim()};"equipment"===s&&(d.slot=A,d.equipped=!1,d.modifiers=function(){let a={},b={},c={},d={};for(let b of e){let c=j(C[b]??"0",0);0!==c&&(a[b]=c)}for(let a of e){let c=j(E[a]??"0",0);0!==c&&(b[a]=c)}for(let a of f){let b=j(G[a.key]??"0",0);0!==b&&(c[a.key]=b)}for(let a of g){let b=j(I[a.key]??"0",0);0!==b&&(d[a.key]=b)}let h={};return Object.keys(a).length&&(h.abilities=a),Object.keys(b).length&&(h.saves=b),Object.keys(c).length&&(h.skills=c),Object.keys(d).length&&(h.derived=d),h}());let h=[d,...q];await Q(h)&&(v(""),x("1"),z(""),D(Object.fromEntries(e.map(a=>[a,"0"]))),F(Object.fromEntries(e.map(a=>[a,"0"]))),H(Object.fromEntries(f.map(a=>[a.key,"0"]))),J(Object.fromEntries(g.map(a=>[a.key,"0"]))))}async function S(a){await Q(q.filter(b=>b.id!==a))}async function T(a,b){let c=q.map(c=>{if(c.id!==a)return c;let d=Math.max(0,b);return"equipment"===c.kind?{...c,qty:d,equipped:d>0&&c.equipped}:"key"===c.kind?{...c,qty:1}:{...c,qty:d}});await Q(c)}async function U(a,b){let c=q.map(c=>c.id===a?{...c,...b}:c);await Q(c)}async function V(a,b){let c=q.find(b=>b.id===a);if(!c||"equipment"!==c.kind)return;let d=c.slot??"main_hand",e=q.map(c=>c.id===a?{...c,equipped:b&&(c.qty??0)>0}:c);if(b)if("accessory"===d){let b=e.filter(a=>"equipment"===a.kind&&"accessory"===a.slot&&a.equipped);if(b.length>2){let c=b.find(b=>b.id!==a);if(c){let a=e.findIndex(a=>a.id===c.id);a>=0&&(e[a]={...e[a],equipped:!1})}}}else for(let b=0;b<e.length;b++){let c=e[b];c.id!==a&&"equipment"===c.kind&&(c.slot??"main_hand")===d&&c.equipped&&(e[b]={...c,equipped:!1})}await Q(e)}function W(a){let c="equipment"===a.kind,d="consumable"===a.kind||"other"===a.kind||"equipment"===a.kind,h=c?function(a){let b=!!a.equipped,c=[],d=a.modifiers?.abilities??{},h=a.modifiers?.saves??{},i=a.modifiers?.skills??{},j=a.modifiers?.derived??{};for(let a of e){let b=d[a];Number.isInteger(b)&&0!==b&&c.push(`Core ${a}: ${l(b)}`)}for(let a of e){let b=h[a];Number.isInteger(b)&&0!==b&&c.push(`Save ${a}: ${l(b)}`)}for(let a of f){let b=i[a.key];Number.isInteger(b)&&0!==b&&c.push(`${a.label}: ${l(b)}`)}for(let a of g){let b=j[a.key];Number.isInteger(b)&&0!==b&&c.push(`${a.label}: ${l(b)}`)}return 0===c.length&&c.push("No modifiers set."),{active:b,lines:c}}(a):null;return(0,b.jsxs)("li",{className:"border rounded-lg p-3 space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3 flex-wrap",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"font-medium",children:a.name}),(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:[a.kind.toUpperCase(),c&&a.slot?` \xb7 slot: ${k(a.slot)}`:"",c?` \xb7 equipped: ${String(!!a.equipped)}`:""]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[c?(0,b.jsxs)("label",{className:"flex items-center gap-2 select-none text-sm",children:[(0,b.jsx)("input",{type:"checkbox",checked:!!a.equipped,disabled:K||(a.qty??0)<=0,onChange:b=>V(a.id,b.target.checked)}),"Equipped"]}):null,d?(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{className:"border rounded-md px-2 py-1 hover:bg-gray-50 disabled:opacity-50",type:"button",disabled:K||a.qty<=0||"key"===a.kind,onClick:()=>T(a.id,a.qty-1),children:"−"}),(0,b.jsx)("div",{className:"w-10 text-center",children:a.qty}),(0,b.jsx)("button",{className:"border rounded-md px-2 py-1 hover:bg-gray-50 disabled:opacity-50",type:"button",disabled:K||"key"===a.kind,onClick:()=>T(a.id,a.qty+1),children:"+"})]}):null,(0,b.jsx)("button",{className:"border rounded-md px-3 py-1 hover:bg-gray-50 disabled:opacity-50",type:"button",disabled:K,onClick:()=>S(a.id),children:"Delete"})]})]}),(0,b.jsx)("div",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:a.description?.trim()?a.description:(0,b.jsx)("span",{className:"text-gray-400",children:"No description."})}),c&&h?(0,b.jsxs)("div",{className:"text-xs text-gray-600",children:[(0,b.jsxs)("div",{className:"font-medium",children:["Active modifiers ",h.active?"(active)":"(inactive)"]}),(0,b.jsxs)("ul",{className:"list-disc pl-5",children:[h.lines.slice(0,6).map((a,c)=>(0,b.jsx)("li",{children:a},c)),h.lines.length>6?(0,b.jsxs)("li",{children:["…and ",h.lines.length-6," more"]}):null]}),h.active?null:(0,b.jsx)("div",{className:"text-gray-500",children:"Equip the item to activate modifiers."})]}):null,(0,b.jsxs)("details",{className:"border rounded-md p-2",children:[(0,b.jsx)("summary",{className:"cursor-pointer text-sm",children:"Edit item"}),(0,b.jsxs)("div",{className:"mt-3 space-y-4",children:[(0,b.jsx)("textarea",{className:"border rounded-md p-2 w-full",rows:3,defaultValue:a.description??"",placeholder:"Description",onBlur:b=>U(a.id,{description:b.target.value})}),c?(0,b.jsx)("div",{className:"grid gap-2 sm:grid-cols-2",children:(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Slot"}),(0,b.jsxs)("select",{className:"border rounded-md p-2 w-full",value:a.slot??"main_hand",disabled:K,onChange:b=>U(a.id,{slot:b.target.value}),children:[(0,b.jsx)("option",{value:"main_hand",children:"Main hand"}),(0,b.jsx)("option",{value:"offhand",children:"Offhand"}),(0,b.jsx)("option",{value:"head",children:"Head"}),(0,b.jsx)("option",{value:"body",children:"Body"}),(0,b.jsx)("option",{value:"hands",children:"Hands"}),(0,b.jsx)("option",{value:"legs",children:"Legs"}),(0,b.jsx)("option",{value:"feet",children:"Feet"}),(0,b.jsx)("option",{value:"accessory",children:"Accessory"})]})]})}):null,c?(0,b.jsxs)("div",{className:"border rounded-lg p-3 space-y-3",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Modifiers"}),(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Only equipped equipment applies modifiers. Zero values are ignored."}),(0,b.jsxs)("div",{className:"grid gap-3 lg:grid-cols-3",children:[(0,b.jsxs)("div",{className:"border rounded-lg p-3 space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Core stats"}),e.map(c=>(0,b.jsxs)("label",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("span",{className:"text-sm capitalize",children:c}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-24",defaultValue:String(a.modifiers?.abilities?.[c]??0),inputMode:"numeric",onBlur:b=>{let d=j(b.target.value,0),e={...a.modifiers??{},abilities:{...a.modifiers?.abilities??{},[c]:d}};U(a.id,{modifiers:e})}})]},c))]}),(0,b.jsxs)("div",{className:"border rounded-lg p-3 space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Saving throws"}),e.map(c=>(0,b.jsxs)("label",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("span",{className:"text-sm capitalize",children:c}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-24",defaultValue:String(a.modifiers?.saves?.[c]??0),inputMode:"numeric",onBlur:b=>{let d=j(b.target.value,0),e={...a.modifiers??{},saves:{...a.modifiers?.saves??{},[c]:d}};U(a.id,{modifiers:e})}})]},c))]}),(0,b.jsxs)("div",{className:"border rounded-lg p-3 space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Derived"}),g.map(c=>(0,b.jsxs)("label",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("span",{className:"text-sm",children:c.label}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-24",defaultValue:String(a.modifiers?.derived?.[c.key]??0),inputMode:"numeric",onBlur:b=>{let d=j(b.target.value,0),e={...a.modifiers??{},derived:{...a.modifiers?.derived??{},[c.key]:d}};U(a.id,{modifiers:e})}})]},c.key))]})]}),(0,b.jsxs)("details",{className:"border rounded-md p-2",children:[(0,b.jsx)("summary",{className:"cursor-pointer text-sm",children:"Skill modifiers (advanced)"}),(0,b.jsx)("div",{className:"mt-2 grid gap-2 sm:grid-cols-2 lg:grid-cols-3",children:f.map(c=>(0,b.jsxs)("label",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("span",{className:"text-sm",children:c.label}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-24",defaultValue:String(a.modifiers?.skills?.[c.key]??0),inputMode:"numeric",onBlur:b=>{let d=j(b.target.value,0),e={...a.modifiers??{},skills:{...a.modifiers?.skills??{},[c.key]:d}};U(a.id,{modifiers:e})}})]},c.key))})]})]}):null,(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Edits save when you click out of a field."})]})]})]},a.id)}return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("form",{onSubmit:R,className:"border rounded-xl p-4 space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[(0,b.jsx)("h3",{className:"font-medium",children:"Add item"}),K?(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"Saving…"}):null]}),(0,b.jsxs)("div",{className:"grid gap-2 sm:grid-cols-3",children:[(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Kind"}),(0,b.jsxs)("select",{className:"border rounded-md p-2 w-full",value:s,onChange:a=>t(a.target.value),children:[(0,b.jsx)("option",{value:"equipment",children:"Equipment"}),(0,b.jsx)("option",{value:"consumable",children:"Consumable"}),(0,b.jsx)("option",{value:"key",children:"Key item"}),(0,b.jsx)("option",{value:"other",children:"Other"})]})]}),(0,b.jsxs)("label",{className:"space-y-1 sm:col-span-2",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Name"}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",placeholder:"Item name",value:u,onChange:a=>v(a.target.value)})]})]}),(0,b.jsxs)("div",{className:"grid gap-2 sm:grid-cols-3",children:[(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Qty"}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",value:"key"===s?"1":w,onChange:a=>x(a.target.value),inputMode:"numeric",disabled:"key"===s})]}),"equipment"===s?(0,b.jsxs)("label",{className:"space-y-1 sm:col-span-2",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Slot"}),(0,b.jsxs)("select",{className:"border rounded-md p-2 w-full",value:A,onChange:a=>B(a.target.value),children:[(0,b.jsx)("option",{value:"main_hand",children:"Main hand"}),(0,b.jsx)("option",{value:"offhand",children:"Offhand"}),(0,b.jsx)("option",{value:"head",children:"Head"}),(0,b.jsx)("option",{value:"body",children:"Body"}),(0,b.jsx)("option",{value:"hands",children:"Hands"}),(0,b.jsx)("option",{value:"legs",children:"Legs"}),(0,b.jsx)("option",{value:"feet",children:"Feet"}),(0,b.jsx)("option",{value:"accessory",children:"Accessory"})]})]}):(0,b.jsx)("div",{className:"sm:col-span-2"})]}),(0,b.jsx)("textarea",{className:"border rounded-md p-2 w-full",rows:3,placeholder:"Description",value:y,onChange:a=>z(a.target.value)}),"equipment"===s?(0,b.jsxs)("details",{className:"border rounded-md p-2",children:[(0,b.jsx)("summary",{className:"cursor-pointer text-sm",children:"Set modifiers (optional)"}),(0,b.jsxs)("div",{className:"mt-3 grid gap-3 lg:grid-cols-3",children:[(0,b.jsxs)("div",{className:"border rounded-lg p-3 space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Core stats"}),e.map(a=>(0,b.jsxs)("label",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("span",{className:"text-sm capitalize",children:a}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-24",value:C[a]??"0",inputMode:"numeric",onChange:b=>D(c=>({...c,[a]:b.target.value}))})]},a))]}),(0,b.jsxs)("div",{className:"border rounded-lg p-3 space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Saving throws"}),e.map(a=>(0,b.jsxs)("label",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("span",{className:"text-sm capitalize",children:a}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-24",value:E[a]??"0",inputMode:"numeric",onChange:b=>F(c=>({...c,[a]:b.target.value}))})]},a))]}),(0,b.jsxs)("div",{className:"border rounded-lg p-3 space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:"Derived"}),g.map(a=>(0,b.jsxs)("label",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("span",{className:"text-sm",children:a.label}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-24",value:I[a.key]??"0",inputMode:"numeric",onChange:b=>J(c=>({...c,[a.key]:b.target.value}))})]},a.key))]})]}),(0,b.jsxs)("details",{className:"border rounded-md p-2 mt-3",children:[(0,b.jsx)("summary",{className:"cursor-pointer text-sm",children:"Skill modifiers (advanced)"}),(0,b.jsx)("div",{className:"mt-2 grid gap-2 sm:grid-cols-2 lg:grid-cols-3",children:f.map(a=>(0,b.jsxs)("label",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("span",{className:"text-sm",children:a.label}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-24",value:G[a.key]??"0",inputMode:"numeric",onChange:b=>H(c=>({...c,[a.key]:b.target.value}))})]},a.key))})]})]}):null,M&&(0,b.jsx)("p",{className:"text-sm text-red-600",children:M}),(0,b.jsx)("button",{className:"px-3 py-2 rounded-lg border bg-black text-white hover:opacity-90 disabled:opacity-50",disabled:K,children:"Add item"})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("section",{className:"space-y-3",children:[(0,b.jsx)("h3",{className:"font-medium",children:"Equipment"}),0===O.eq.length?(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"None."}):(0,b.jsx)("div",{className:"space-y-4",children:h.map(a=>{let c=P.get(a)??[];return 0===c.length?null:(0,b.jsxs)("div",{className:"border rounded-xl p-3 space-y-2",children:[(0,b.jsx)("div",{className:"text-sm font-medium",children:k(a)}),(0,b.jsx)("ul",{className:"space-y-2",children:c.map(W)})]},a)})})]}),(0,b.jsxs)("section",{className:"space-y-2",children:[(0,b.jsx)("h3",{className:"font-medium",children:"Consumables"}),0===O.con.length?(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"None."}):(0,b.jsx)("ul",{className:"space-y-2",children:O.con.map(W)})]}),(0,b.jsxs)("section",{className:"space-y-2",children:[(0,b.jsx)("h3",{className:"font-medium",children:"Key items"}),0===O.key.length?(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"None."}):(0,b.jsx)("ul",{className:"space-y-2",children:O.key.map(W)})]}),(0,b.jsxs)("section",{className:"space-y-2",children:[(0,b.jsx)("h3",{className:"font-medium",children:"Other"}),0===O.oth.length?(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"None."}):(0,b.jsx)("ul",{className:"space-y-2",children:O.oth.map(W)})]})]})]})}a.s(["default",()=>o])},72997,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);function e({campaignId:a,characterId:e,initialIsNpc:f}){let g=(0,d.useRouter)(),[h,i]=(0,c.useState)(f),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(null);async function n(b){m(null),k(!0);let c=await fetch("/api/characters/set-npc",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:a,characterId:e,isNpc:b})}),d=await c.json().catch(()=>({}));(k(!1),c.ok)?(i(b),g.refresh()):m(d?.error??"Failed to update NPC flag.")}return(0,b.jsxs)("div",{className:"space-y-2",children:[l&&(0,b.jsx)("p",{className:"text-sm text-red-600",children:l}),(0,b.jsxs)("label",{className:"flex items-center gap-2 select-none",children:[(0,b.jsx)("input",{type:"checkbox",checked:h,disabled:j,onChange:a=>n(a.target.checked)}),(0,b.jsx)("span",{className:"text-sm",children:"NPC character"})]}),(0,b.jsx)("p",{className:"text-xs text-gray-600",children:"Used by “Skip NPC” when pushing monsters to all characters."})]})}a.s(["default",()=>e])},46242,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);let e=["physical","mental","magic","intelligence","diplomacy","incivility"],f=[{key:"acrobatics",label:"Acrobatics",ability:"physical"},{key:"athletics",label:"Athletics",ability:"physical"},{key:"communication",label:"Communication",ability:"diplomacy"},{key:"deception",label:"Deception",ability:"incivility"},{key:"history",label:"History",ability:"intelligence"},{key:"identification",label:"Identification",ability:"magic"},{key:"insight",label:"Insight",ability:"diplomacy"},{key:"intimidation",label:"Intimidation",ability:"incivility"},{key:"investigation",label:"Investigation",ability:"intelligence"},{key:"learning",label:"Learning",ability:"mental"},{key:"perception",label:"Perception",ability:"mental"},{key:"performance",label:"Performance",ability:"incivility"},{key:"persuasion",label:"Persuasion",ability:"diplomacy"},{key:"sleight_of_hand",label:"Sleight of Hand",ability:"physical"},{key:"spells",label:"Spells",ability:"magic"}],g=[{key:"astronomy",label:"Astronomy"},{key:"care_of_magical_creatures",label:"Care of Magical Creatures"},{key:"charms",label:"Charms"},{key:"defense_against_the_dark_arts",label:"Defense Against the Dark Arts"},{key:"herbology",label:"Herbology"},{key:"potions",label:"Potions"},{key:"transfiguration",label:"Transfiguration"}],h=["F","E","D","C","B","A"];function i(a,b=0){let c=Number(a);return Number.isFinite(c)?Math.trunc(c):b}function j(a){return a>=0?`+${a}`:`${a}`}function k(){return{subjects:g.map(a=>({key:a.key,grade:"F",proficient:!1})),notes:""}}function l(a){let b=k(),c=new Map;if(a&&Array.isArray(a.subjects))for(let b of a.subjects)b&&"string"==typeof b.key&&c.set(b.key,b);return{subjects:g.map(a=>{var b;let d=c.get(a.key),e="string"==typeof(b=d?.grade)&&h.includes(b)?d.grade:"F",f=!!d?.proficient;return{key:a.key,grade:e,proficient:f}}),notes:"string"==typeof a?.notes?a.notes:b.notes}}function m(a){let b=Number(a);return Number.isFinite(b)?b:0}function n(a,b){let c=Object.fromEntries(b.map(a=>[a,0]));for(let d of a)if(d)for(let a of b)c[a]+=m(d[a]);return c}function o({campaignId:a,characterId:o,initialCharacterSheet:p,initialReportCard:q,initialItems:r}){let s=(0,d.useRouter)(),[t,u]=(0,c.useState)(()=>(function(a,b){let c=JSON.parse(JSON.stringify({level:1,proficiencyBonus:0,abilities:{physical:10,mental:10,magic:10,intelligence:10,diplomacy:10,incivility:10},savingThrowProficiencies:{physical:!1,mental:!1,magic:!1,intelligence:!1,diplomacy:!1,incivility:!1},skillProficiencies:{acrobatics:!1,athletics:!1,communication:!1,deception:!1,history:!1,identification:!1,insight:!1,intimidation:!1,investigation:!1,learning:!1,perception:!1,performance:!1,persuasion:!1,sleight_of_hand:!1,spells:!1},reportCard:k(),derived:{hpCurrent:10,hpMaxOverride:null,acOverride:null,initiativeOverride:null,speedOverride:null,passivePerceptionOverride:null}}));if(a&&"object"==typeof a){if(Number.isInteger(a.level)&&(c.level=a.level),Number.isInteger(a.proficiencyBonus)&&(c.proficiencyBonus=a.proficiencyBonus),a.abilities&&"object"==typeof a.abilities)for(let b of e)Number.isInteger(a.abilities[b])&&(c.abilities[b]=a.abilities[b]);if(a.savingThrowProficiencies&&"object"==typeof a.savingThrowProficiencies)for(let b of e)c.savingThrowProficiencies[b]=!!a.savingThrowProficiencies[b];if(a.skillProficiencies&&"object"==typeof a.skillProficiencies)for(let b of f)c.skillProficiencies[b.key]=!!a.skillProficiencies[b.key];if(a.derived&&"object"==typeof a.derived){let b=a.derived;Number.isInteger(b.hpCurrent)&&(c.derived.hpCurrent=b.hpCurrent),c.derived.hpMaxOverride=Number.isInteger(b.hpMaxOverride)?b.hpMaxOverride:null,c.derived.acOverride=Number.isInteger(b.acOverride)?b.acOverride:null,c.derived.initiativeOverride=Number.isInteger(b.initiativeOverride)?b.initiativeOverride:null,c.derived.speedOverride=Number.isInteger(b.speedOverride)?b.speedOverride:null,c.derived.passivePerceptionOverride=Number.isInteger(b.passivePerceptionOverride)?b.passivePerceptionOverride:null}a.reportCard&&(c.reportCard=l(a.reportCard))}return!a?.reportCard&&b&&(c.reportCard=l(b)),c})(p,q)),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(null),z=Array.isArray(r)?r:[],A=(0,c.useMemo)(()=>z.filter(a=>a?.kind==="equipment"&&a?.equipped&&(a.qty??0)>0),[z]),B=(0,c.useMemo)(()=>n(A.map(a=>a.modifiers?.abilities),e),[A]),C=(0,c.useMemo)(()=>n(A.map(a=>a.modifiers?.saves),e),[A]),D=(0,c.useMemo)(()=>{let a=f.map(a=>a.key);return n(A.map(a=>a.modifiers?.skills),a)},[A]),E=(0,c.useMemo)(()=>{let a={hpMax:0,ac:0,initiative:0,speed:0,passivePerception:0};for(let b of A){let c=b.modifiers?.derived;c&&(a.hpMax+=m(c.hpMax),a.ac+=m(c.ac),a.initiative+=m(c.initiative),a.speed+=m(c.speed),a.passivePerception+=m(c.passivePerception))}return a},[A]),F=(0,c.useMemo)(()=>{let a={};for(let b of e)a[b]=(t.abilities[b]??0)+(B[b]??0);return a},[t.abilities,B]),G=(0,c.useMemo)(()=>{let a={};for(let b of e)a[b]=Math.floor((Number(F[b])-10)/2);return a},[F]),H=G.intelligence>G.mental?"intelligence":"mental";function I(a){return"learning"===a?H:f.find(b=>b.key===a).ability}let J=(0,c.useMemo)(()=>10*(t.level+G.physical),[t.level,G.physical]),K=t.derived.hpMaxOverride??J,L=K+E.hpMax,M=t.derived.acOverride??10,N=M+E.ac,O=G.mental,P=t.derived.initiativeOverride??O,Q=P+E.initiative,R=t.derived.speedOverride??8,S=R+E.speed,T=10+G.mental,U=t.derived.passivePerceptionOverride??T,V=U+E.passivePerception,W=Math.floor((Number(t.proficiencyBonus)||0)/2);async function X(){y(null),w(!0);let b=await fetch("/api/characters/character-sheet/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:a,characterId:o,characterSheet:t})}),c=await b.json().catch(()=>({}));return(w(!1),b.ok)?(s.refresh(),!0):(y(c?.error??"Failed to save character sheet."),!1)}return(0,b.jsxs)("div",{className:"space-y-6",children:[x?(0,b.jsx)("p",{className:"text-sm text-red-600",children:x}):null,(0,b.jsxs)("section",{className:"border rounded-xl p-4 space-y-3",children:[(0,b.jsx)("h3",{className:"font-medium",children:"Identity"}),(0,b.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Level"}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",value:String(t.level),inputMode:"numeric",onChange:a=>u(b=>({...b,level:i(a.target.value,b.level)}))})]}),(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Proficiency bonus"}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",value:String(t.proficiencyBonus),inputMode:"numeric",onChange:a=>u(b=>({...b,proficiencyBonus:i(a.target.value,b.proficiencyBonus)}))}),(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:["Report card proficiency steps: ",(0,b.jsx)("span",{className:"font-medium",children:W})]})]})]}),A.length?(0,b.jsxs)("div",{className:"text-xs text-gray-600",children:["Equipped items affecting stats: ",(0,b.jsx)("span",{className:"font-medium",children:A.length})]}):(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"No equipped equipment modifiers active."})]}),(0,b.jsxs)("section",{className:"border rounded-xl p-4 space-y-3",children:[(0,b.jsx)("h3",{className:"font-medium",children:"Core stats"}),(0,b.jsxs)("div",{className:"text-xs text-gray-600",children:["Enter the ",(0,b.jsx)("span",{className:"font-medium",children:"base score"}),". Equipment modifiers change the effective score/modifier."]}),(0,b.jsx)("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:e.map(a=>{let c=t.abilities[a]??0,d=B[a]??0,e=F[a]??0;return(0,b.jsxs)("div",{className:"border rounded-lg p-3 space-y-2",children:[(0,b.jsx)("div",{className:"font-medium capitalize",children:a}),(0,b.jsxs)("label",{className:"space-y-1 block",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Base score"}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",value:String(c),inputMode:"numeric",onChange:b=>u(c=>({...c,abilities:{...c.abilities,[a]:i(b.target.value,c.abilities[a])}}))})]}),(0,b.jsxs)("div",{className:"text-sm text-gray-700",children:["Effective score:"," ",(0,b.jsx)("span",{className:"font-semibold",children:e}),0!==d?(0,b.jsxs)("span",{className:"text-xs text-gray-500",children:[" (equipment ",j(d),")"]}):null]}),(0,b.jsxs)("div",{className:"text-sm text-gray-700",children:["Modifier: ",(0,b.jsx)("span",{className:"font-semibold",children:j(G[a])})]})]},a)})})]}),(0,b.jsxs)("section",{className:"border rounded-xl p-4 space-y-3",children:[(0,b.jsx)("h3",{className:"font-medium",children:"Saving throws"}),(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Total = ability mod + (proficiency if proficient) + equipment save bonuses."}),(0,b.jsx)("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:e.map(a=>{var c;return(0,b.jsxs)("div",{className:"border rounded-lg p-3 space-y-2",children:[(0,b.jsx)("div",{className:"font-medium capitalize",children:a}),(0,b.jsxs)("div",{className:"text-sm text-gray-700",children:["Base mod: ",(0,b.jsx)("span",{className:"font-medium",children:j(G[a])})]}),C[a]?(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:["Equip bonus: ",j(C[a])]}):null,(0,b.jsxs)("label",{className:"flex items-center gap-2 select-none",children:[(0,b.jsx)("input",{type:"checkbox",checked:t.savingThrowProficiencies[a],onChange:b=>u(c=>({...c,savingThrowProficiencies:{...c.savingThrowProficiencies,[a]:b.target.checked}}))}),(0,b.jsx)("span",{className:"text-sm",children:"Proficient"})]}),(0,b.jsxs)("div",{className:"text-sm text-gray-700",children:["Total:"," ",(0,b.jsx)("span",{className:"font-semibold",children:j((c=t.savingThrowProficiencies[a],G[a]+(c?t.proficiencyBonus:0)+(C[a]??0)))})]})]},a)})})]}),(0,b.jsxs)("section",{className:"border rounded-xl p-4 space-y-3",children:[(0,b.jsx)("h3",{className:"font-medium",children:"Skills"}),(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Total = base ability mod + (proficiency if proficient) + equipment skill bonuses. Learning uses higher of Mental/Intelligence."}),(0,b.jsxs)("div",{className:"border rounded-xl overflow-hidden",children:[(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-2 p-3 text-xs text-gray-600 border-b",children:[(0,b.jsx)("div",{className:"col-span-5 font-medium",children:"Skill"}),(0,b.jsx)("div",{className:"col-span-3 font-medium",children:"Base stat"}),(0,b.jsx)("div",{className:"col-span-2 font-medium",children:"Proficient"}),(0,b.jsx)("div",{className:"col-span-2 font-medium",children:"Total"})]}),f.map(a=>{var c;let d=I(a.key),e=G[I(c=a.key)]+(t.skillProficiencies[c]?t.proficiencyBonus:0)+(D[c]??0),f=D[a.key]??0;return(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-2 p-3 border-b last:border-b-0 items-center",children:[(0,b.jsx)("div",{className:"col-span-5 font-medium",children:a.label}),(0,b.jsxs)("div",{className:"col-span-3",children:["learning"===a.key?(0,b.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,b.jsx)("span",{className:"capitalize font-medium",children:d})," ",(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"(higher mod of Mental/Int)"})]}):(0,b.jsx)("div",{className:"text-sm text-gray-700 capitalize",children:d}),(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:["Base mod: ",j(G[d])]}),0!==f?(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:["Equip bonus: ",j(f)]}):null]}),(0,b.jsxs)("div",{className:"col-span-2 flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:t.skillProficiencies[a.key],onChange:b=>u(c=>({...c,skillProficiencies:{...c.skillProficiencies,[a.key]:b.target.checked}}))}),(0,b.jsx)("span",{className:"text-sm",children:"Yes"})]}),(0,b.jsx)("div",{className:"col-span-2 font-semibold",children:j(e)})]},a.key)})]})]}),(0,b.jsxs)("section",{className:"border rounded-xl p-4 space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-medium",children:"Knowledge (Report card)"}),(0,b.jsxs)("div",{className:"text-xs text-gray-600",children:["If proficient: effective grade increases by ",(0,b.jsx)("span",{className:"font-medium",children:W})," (capped at A)."]})]}),(0,b.jsxs)("div",{className:"border rounded-xl overflow-hidden",children:[(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-2 p-3 text-xs text-gray-600 border-b",children:[(0,b.jsx)("div",{className:"col-span-5 font-medium",children:"Class"}),(0,b.jsx)("div",{className:"col-span-3 font-medium",children:"Base grade"}),(0,b.jsx)("div",{className:"col-span-2 font-medium",children:"Proficient"}),(0,b.jsx)("div",{className:"col-span-2 font-medium",children:"Effective"})]}),g.map(a=>{var c,d,e,f;let g,i=t.reportCard.subjects.find(b=>b.key===a.key)??{key:a.key,grade:"F",proficient:!1},j=(c=i.grade,d=i.proficient,e=t.proficiencyBonus,g=h.indexOf(c),h[f=g+(d?Math.floor((Number(e)||0)/2):0),Math.max(0,Math.min(h.length-1,f))]);return(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-2 p-3 border-b last:border-b-0 items-center",children:[(0,b.jsx)("div",{className:"col-span-5 font-medium",children:a.label}),(0,b.jsx)("div",{className:"col-span-3",children:(0,b.jsx)("select",{className:"border rounded-md p-2 w-full",value:i.grade,disabled:v,onChange:b=>u(c=>({...c,reportCard:{...c.reportCard,subjects:c.reportCard.subjects.map(c=>c.key===a.key?{...c,grade:b.target.value}:c)}})),children:h.map(a=>(0,b.jsx)("option",{value:a,children:a},a))})}),(0,b.jsxs)("div",{className:"col-span-2 flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:i.proficient,disabled:v,onChange:b=>u(c=>({...c,reportCard:{...c.reportCard,subjects:c.reportCard.subjects.map(c=>c.key===a.key?{...c,proficient:b.target.checked}:c)}}))}),(0,b.jsx)("span",{className:"text-sm",children:"Yes"})]}),(0,b.jsx)("div",{className:"col-span-2 font-semibold",children:j})]},a.key)})]}),(0,b.jsx)("textarea",{className:"border rounded-md p-2 w-full",rows:3,placeholder:"Notes (optional)",value:t.reportCard.notes??"",disabled:v,onChange:a=>u(b=>({...b,reportCard:{...b.reportCard,notes:a.target.value}}))}),(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Notes are saved when you press “Save character sheet”."})]}),(0,b.jsxs)("section",{className:"border rounded-xl p-4 space-y-3",children:[(0,b.jsx)("h3",{className:"font-medium",children:"Combat & derived"}),(0,b.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:[(0,b.jsxs)("div",{className:"border rounded-lg p-3 space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Max HP"}),(0,b.jsxs)("div",{className:"text-sm text-gray-700",children:["Base: ",(0,b.jsx)("span",{className:"font-medium",children:K})," ",(0,b.jsxs)("span",{className:"text-xs text-gray-500",children:["(default ",J,")"]})]}),E.hpMax?(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:["Equip bonus: ",j(E.hpMax)]}):null,(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",placeholder:"Override (optional)",value:null===t.derived.hpMaxOverride?"":String(t.derived.hpMaxOverride),inputMode:"numeric",onChange:a=>u(b=>({...b,derived:{...b.derived,hpMaxOverride:""===a.target.value.trim()?null:i(a.target.value,0)}}))}),(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:["Effective: ",L]})]}),(0,b.jsxs)("div",{className:"border rounded-lg p-3 space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Current HP"}),(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",value:String(t.derived.hpCurrent),inputMode:"numeric",onChange:a=>u(b=>({...b,derived:{...b.derived,hpCurrent:i(a.target.value,b.derived.hpCurrent)}}))}),(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:["Out of ",L]})]}),(0,b.jsxs)("div",{className:"border rounded-lg p-3 space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Armor Class"}),(0,b.jsxs)("div",{className:"text-sm text-gray-700",children:["Base: ",(0,b.jsx)("span",{className:"font-medium",children:M})]}),E.ac?(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:["Equip bonus: ",j(E.ac)]}):null,(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",placeholder:"Override (optional)",value:null===t.derived.acOverride?"":String(t.derived.acOverride),inputMode:"numeric",onChange:a=>u(b=>({...b,derived:{...b.derived,acOverride:""===a.target.value.trim()?null:i(a.target.value,0)}}))}),(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:["Effective: ",N]})]}),(0,b.jsxs)("div",{className:"border rounded-lg p-3 space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Initiative"}),(0,b.jsxs)("div",{className:"text-sm text-gray-700",children:["Base: ",(0,b.jsx)("span",{className:"font-medium",children:P})]}),E.initiative?(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:["Equip bonus: ",j(E.initiative)]}):null,(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",placeholder:"Override (optional)",value:null===t.derived.initiativeOverride?"":String(t.derived.initiativeOverride),inputMode:"numeric",onChange:a=>u(b=>({...b,derived:{...b.derived,initiativeOverride:""===a.target.value.trim()?null:i(a.target.value,0)}}))}),(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:["Effective: ",Q]})]}),(0,b.jsxs)("div",{className:"border rounded-lg p-3 space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Speed"}),(0,b.jsxs)("div",{className:"text-sm text-gray-700",children:["Base: ",(0,b.jsx)("span",{className:"font-medium",children:R})]}),E.speed?(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:["Equip bonus: ",j(E.speed)]}):null,(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",placeholder:"Override (optional)",value:null===t.derived.speedOverride?"":String(t.derived.speedOverride),inputMode:"numeric",onChange:a=>u(b=>({...b,derived:{...b.derived,speedOverride:""===a.target.value.trim()?null:i(a.target.value,0)}}))}),(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:["Effective: ",S]})]}),(0,b.jsxs)("div",{className:"border rounded-lg p-3 space-y-1",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600",children:"Passive Perception"}),(0,b.jsxs)("div",{className:"text-sm text-gray-700",children:["Base: ",(0,b.jsx)("span",{className:"font-medium",children:U})]}),E.passivePerception?(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:["Equip bonus: ",j(E.passivePerception)]}):null,(0,b.jsx)("input",{className:"border rounded-md p-2 w-full",placeholder:"Override (optional)",value:null===t.derived.passivePerceptionOverride?"":String(t.derived.passivePerceptionOverride),inputMode:"numeric",onChange:a=>u(b=>({...b,derived:{...b.derived,passivePerceptionOverride:""===a.target.value.trim()?null:i(a.target.value,0)}}))}),(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:["Effective: ",V]})]})]}),(0,b.jsx)("div",{className:"pt-2",children:(0,b.jsx)("button",{type:"button",onClick:X,disabled:v,className:"px-3 py-2 rounded-lg border bg-black text-white hover:opacity-90 disabled:opacity-50",children:v?"Saving…":"Save character sheet"})})]})]})}a.s(["default",()=>o])}];

//# sourceMappingURL=src_app_app_c_%5BcampaignId%5D_characters_%5BcharacterId%5D_d8a44c65._.js.map